{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "mazcacnpenworthadf01"
		},
		"AzureDatabricksDeltaLake1_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'AzureDatabricksDeltaLake1'"
		},
		"AzureDatacopyls_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDatacopyls'"
		},
		"CNE_Azure_Account_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CNE_Azure_Account'"
		},
		"Hdfs1_self_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'Hdfs1_self'"
		},
		"Link_CNE_Storage_Account_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'Link_CNE_Storage_Account'"
		},
		"Oracle_prod_test_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Oracle_prod_test'"
		},
		"UserCredentials_A_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'UserCredentials_A'"
		},
		"UserLevelAccess-S_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'UserLevelAccess-S'"
		},
		"edl_storage_account_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'edl_storage_account'"
		},
		"ls_4_gen2_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'ls_4_gen2'"
		},
		"ls_4_gen2_deletion_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'ls_4_gen2_deletion'"
		},
		"ls_az_sql_dar_db_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_az_sql_dar_db'"
		},
		"ls_az_stg_acc_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_az_stg_acc'"
		},
		"ls_az_storage_table_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_az_storage_table'"
		},
		"ls_bdw_oracle_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_bdw_oracle'"
		},
		"ls_bdw_oracle_qa_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_bdw_oracle_qa'"
		},
		"ls_databricks_networth_raw_accessToken": {
			"type": "secureString",
			"metadata": "Secure string for 'accessToken' of 'ls_databricks_networth_raw'"
		},
		"ls_ora_db_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_ora_db'"
		},
		"ls_oracle_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_oracle'"
		},
		"ls_sqlmi_eda_edl_ctl_fw_db_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ls_sqlmi_eda_edl_ctl_fw_db'"
		},
		"AzureDatacopyls_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mazcacdmtnpesybaseiqstg1.dfs.core.windows.net"
		},
		"AzureKeyVault1_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://ccnpedmtnetworthkv01.vault.azure.net/"
		},
		"Dev_Networth_Hadoop_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd101.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"Dev_Networth_Hadoop_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "serv_netwr_maz_hdp_d@RCI.ROGERS.CA"
		},
		"Hdfs1_self_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd109.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"Hdfs1_self_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "arun.konda@RCI.ROGERS.CA"
		},
		"Link_CNE_Storage_Account_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mazcacdmtnpesybaseiqstg1.dfs.core.windows.net"
		},
		"Networth_Key_Vault_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://ccnpedmtnetworthkv01.vault.azure.net/"
		},
		"UserCredentials_A_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd101.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"UserCredentials_A_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "arun.konda@RCI.ROGERS.CA"
		},
		"UserLevelAccess-S_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd109.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"UserLevelAccess-S_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "srinivasrao.mullapud@RCI.ROGERS.CA"
		},
		"dev_hadoop_connectivity_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd109.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"dev_hadoop_connectivity_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "serv_netwr_maz_hdp_d@RCI.ROGERS.CA"
		},
		"ls_4_gen2_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mazcacnpedmtssdls.dfs.core.windows.net"
		},
		"ls_4_gen2_deletion_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://mazcacnpedmtssdls.dfs.core.windows.net"
		},
		"ls_5g_data_enablment_az_kv_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://dmtnpesybasekeyvault.vault.azure.net/"
		},
		"ls_amazon_awsp3_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "s-db5221ea609b4fe1b.server.transfer.us-east-1.amazonaws.com"
		},
		"ls_amazon_awsp3_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "rogers"
		},
		"ls_cradlepoint_rest_api_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://www.cradlepointecm.com/api/v2"
		},
		"ls_ftp_ntw_server_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "prda5geniq001.rci.rogers.ca"
		},
		"ls_ftp_ntw_server_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "nw-ftp-adf-user"
		},
		"ls_ftp_ntw_server_new_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "dmtsybasvmap001.rci.rogers.ca"
		},
		"ls_ftp_ntw_server_new_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "nw-ftp-adf-user"
		},
		"ls_hdfs_primary_on_prem_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://ehdpdd109.dev.dmt.rogers.com:50070/webhdfs/v1/"
		},
		"ls_hdfs_primary_on_prem_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "serv_netwr_maz_hdp_d@RCI.ROGERS.CA"
		},
		"ls_hdfs_secondary_on_prem_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "http://elxap251.rogers.com:50070/webhdfs/v1/"
		},
		"ls_hdfs_secondary_on_prem_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "serv_5g_maz_hdp_p@RCI.ROGERS.CA"
		},
		"ls_onprem_vm_file_system_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "\\\\mdcnascifs.rci.rogers.ca\\RPA"
		},
		"ls_onprem_vm_file_system_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "SERV_SMKE_FILE_MAZ_P@RCI.ROGERS.CA"
		},
		"ls_sas_sftp_server_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "mdcdmtsasg01.rogers.com"
		},
		"ls_sas_sftp_server_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "serv_smoke_sas_maz_p"
		},
		"ls_smoke_az_kv_properties_typeProperties_baseUrl": {
			"type": "string",
			"defaultValue": "https://dmtnpesmokekeyvault.vault.azure.net/"
		},
		"ookla_http_server_linked_service_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://extracts.ookla.com/files/"
		},
		"ookla_http_server_linked_service_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "rogers_co"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/ADB TEST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Notebook1",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Shared/ADB TEST"
						},
						"linkedServiceName": {
							"referenceName": "Networth_DataBricks",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Networth_DataBricks')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CNE to EDL data copy')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CNE to EDL data copy",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OrcSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "OrcSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "OrcWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ENIQ_EDL_ORC",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "CNE_BlobStorage",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:27:59Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ENIQ_EDL_ORC')]",
				"[concat(variables('factoryId'), '/datasets/CNE_BlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ENIQ_Data_Move')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OrcSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFolderPath": "eniq.db/DC_E_ERBS_EUTRANCELLFDD_V_DAY/DATE_ID=*",
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "OrcSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "OrcWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CNE_BlobStorage",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ENIQ_EDL_ORC",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:27:59Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/CNE_BlobStorage')]",
				"[concat(variables('factoryId'), '/datasets/ENIQ_EDL_ORC')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_ARCHIVER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get  Files to Archive",
						"description": "Lists the files to archive",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "BLOB_Binary_Datasets",
								"type": "DatasetReference",
								"parameters": {
									"CONTAINER": {
										"value": "@pipeline().parameters.RDS_STAGE_LOC",
										"type": "Expression"
									},
									"FOLDER_FILE": {
										"value": "@pipeline().parameters.DEST_TBL",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"childItems",
								"itemName",
								"exists",
								"itemType"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "If file found to archive it",
						"description": "Start to Archive if files are found",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get  Files to Archive",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@activity('Get  Files to Archive').output.exists",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "Copy 2 Archive Blob",
									"description": "This blob would retain for 7 days or so based on blob policy. please check with Admin !!",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "BinarySource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true
											},
											"formatSettings": {
												"type": "BinaryReadSettings"
											}
										},
										"sink": {
											"type": "BinarySink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											}
										},
										"enableStaging": false,
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "ls_az_stg_acc",
												"type": "LinkedServiceReference"
											},
											"path": {
												"value": "@concat('logs/', pipeline().parameters.SRC_TYPE, '/', pipeline().parameters.RDS_STAGE_LOC, '/', pipeline().parameters.DEST_TBL)",
												"type": "Expression"
											}
										},
										"dataIntegrationUnits": 2
									},
									"inputs": [
										{
											"referenceName": "ds_4_deletion",
											"type": "DatasetReference",
											"parameters": {
												"container": {
													"value": "@pipeline().parameters.RDS_STAGE_LOC",
													"type": "Expression"
												},
												"path": {
													"value": "@pipeline().parameters.DEST_TBL",
													"type": "Expression"
												}
											}
										}
									],
									"outputs": [
										{
											"referenceName": "ds_4_deletion",
											"type": "DatasetReference",
											"parameters": {
												"container": {
													"value": "@variables('NW_ARCHIVE_BLOB')",
													"type": "Expression"
												},
												"path": {
													"value": "@concat(pipeline().parameters.SRC_TYPE, '/', pipeline().parameters.DEST_TBL, '/', utcnow())",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"RDS_STAGE_LOC": {
						"type": "string",
						"defaultValue": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')"
					},
					"DEST_TBL": {
						"type": "string",
						"defaultValue": "@pipeline().parameters.DEST_TBL"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "NTW_FTP"
					},
					"ID": {
						"type": "string",
						"defaultValue": "utc_now"
					}
				},
				"variables": {
					"NW_ARCHIVE_BLOB": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-archive"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/BLOB_Binary_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/ds_4_deletion')]",
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_CH_DIM_NODE_PORT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "chdimnodedataprocess",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/app/dmt/network/networth/connected-home/NTBK_DIM_NODE_DETAIL_PORT",
							"baseParameters": {
								"targetCuratedLocation": "/mnt/rogers-eda-derived-prd-sensitive-storage/networth/connected_home/connectedhome/",
								"sourceCuratedLocation": "/mnt/rogers-eda-curated-dev-sensitive-storage/hive/"
							}
						},
						"linkedServiceName": {
							"referenceName": "Networth_DataBricks",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Networth_DataBricks')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_ELT_FACADE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup ELT_METADATA",
						"description": "Looks up for the job config in metadata control  table",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureTableSource",
								"azureTableSourceQuery": {
									"value": "@concat('PartitionKey eq ''', variables('V_METADATA_DEF_PARTITION_KEY'), '''',' and RowKey eq ','''', pipeline().parameters.JOB_NAME, '''',' and IS_ACTIVE eq ','''', 'Y', '''')",
									"type": "Expression"
								},
								"azureTableSourceIgnoreTableNotFound": false
							},
							"dataset": {
								"referenceName": "DS_ETL_LOAD_CONTROL",
								"type": "DatasetReference",
								"parameters": {
									"AZ_STORAGE_TABLE": {
										"value": "@variables('V_ELT_METADATA_TABLE')",
										"type": "Expression"
									}
								}
							}
						}
					},
					{
						"name": "Exec ETL Framework",
						"description": "Invoke the main framework pipeline for Ingestion",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Lookup ELT_METADATA",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_ELT_FRAMEWORK_MAIN",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"QRY": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.QRY",
									"type": "Expression"
								},
								"SRC_TBL_FILE_PATH": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_TBL_FILE_PATH",
									"type": "Expression"
								},
								"DEST_TBL": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DEST_TBL",
									"type": "Expression"
								},
								"DBFS_SAVE_MODE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DBFS_SAVE_MODE",
									"type": "Expression"
								},
								"DBFS_COALESCE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DBFS_COALESCE",
									"type": "Expression"
								},
								"DBFS_PARTITION_BY": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DBFS_PARTITION_BY",
									"type": "Expression"
								},
								"RDS_STAGE_LOC": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.RDS_STAGE_LOC",
									"type": "Expression"
								},
								"DEST_TYPE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DEST_TYPE",
									"type": "Expression"
								},
								"ODS_LOC": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.ODS_LOC",
									"type": "Expression"
								},
								"SRC_TYPE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_TYPE",
									"type": "Expression"
								},
								"RDS_STAGE_FILE_FOLDER": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.RDS_STAGE_FILE_FOLDER",
									"type": "Expression"
								},
								"DBFS_FILE_FORMAT": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.DBFS_FILE_FORMAT",
									"type": "Expression"
								},
								"IS_AZ_AUDIT_COLS_2_ADD": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.IS_AZ_AUDIT_COLS_2_ADD",
									"type": "Expression"
								},
								"SRC_DELTA_COL": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_DELTA_COL",
									"type": "Expression"
								},
								"SRC_TBL_PK_CSV": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_TBL_PK_CSV",
									"type": "Expression"
								},
								"RDS_STAGE_FILE_FORMAT": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.RDS_STAGE_FILE_FORMAT",
									"type": "Expression"
								},
								"SRC_CUSTOM_WHERE_CLAUSE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_CUSTOM_WHERE_CLAUSE",
									"type": "Expression"
								},
								"WINDOW_START_TIME_UTC": {
									"value": "@if(equals(activity('Lookup ELT_METADATA').output.firstRow.CURR_MAX_DELTA_COL_VALUE, 'NULL'), '1970-01-01T00:00:00.4270896Z', activity('Lookup ELT_METADATA').output.firstRow.CURR_MAX_DELTA_COL_VALUE)",
									"type": "Expression"
								},
								"WINDOW_END_TIME_UTC": {
									"value": "@utcnow()",
									"type": "Expression"
								},
								"JOB_NAME": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.JOB_NAME",
									"type": "Expression"
								},
								"EXEC_RUN_ID": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"CURR_MAX_DELTA_COL_VALUE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.CURR_MAX_DELTA_COL_VALUE",
									"type": "Expression"
								},
								"CURR_MAX_DELTA_COL_VALUE_FORMAT": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.CURR_MAX_DELTA_COL_VALUE_FORMAT",
									"type": "Expression"
								},
								"LOAD_TYPE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.LOAD_TYPE",
									"type": "Expression"
								},
								"METADATA_JSON": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow",
									"type": "Expression"
								},
								"SRC_TBL_FILE_NAME_PATTERN": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.SRC_TBL_FILE_NAME_PATTERN",
									"type": "Expression"
								},
								"HDFS_PARTITION_COL_FORMAT": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.HDFS_PARTITION_COL_FORMAT",
									"type": "Expression"
								},
								"PARTITION_THRESHOLD": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.PARTITION_THRESHOLD",
									"type": "Expression"
								},
								"PARTITION_THRESHOLD_TYPE": {
									"value": "@activity('Lookup ELT_METADATA').output.firstRow.PARTITION_THRESHOLD_TYPE",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Insrt EtlLoadControl_START",
						"description": "Creates a log entry indicating the START of the job",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Lookup ELT_METADATA",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureTableSource",
								"additionalColumns": [
									{
										"name": "RUN_STATUS",
										"value": "STARTED"
									},
									{
										"name": "RUN_ID",
										"value": {
											"value": "@pipeline().RunId",
											"type": "Expression"
										}
									},
									{
										"name": "RUN_MESSAGE",
										"value": "Starting to invoke the Exec Framework Main PL"
									}
								],
								"azureTableSourceQuery": {
									"value": "@concat('PartitionKey eq ''', variables('V_METADATA_DEF_PARTITION_KEY'), '''',' and RowKey eq ','''', pipeline().parameters.JOB_NAME, '''')",
									"type": "Expression"
								},
								"azureTableSourceIgnoreTableNotFound": false
							},
							"sink": {
								"type": "AzureTableSink",
								"azureTableInsertType": "merge",
								"azureTableDefaultPartitionKeyValue": {
									"value": "@pipeline().parameters.JOB_NAME",
									"type": "Expression"
								},
								"writeBatchSize": 10000
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PartitionKey",
											"type": "String"
										},
										"sink": {
											"name": "PartitionKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RowKey",
											"type": "String"
										},
										"sink": {
											"name": "RowKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Timestamp",
											"type": "DateTimeOffset"
										},
										"sink": {
											"name": "Timestamp",
											"type": "DateTimeOffset"
										}
									},
									{
										"source": {
											"name": "RUN_ID",
											"type": "String"
										},
										"sink": {
											"name": "EXEC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RUN_MESSAGE",
											"type": "String"
										},
										"sink": {
											"name": "MESSAGE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RUN_STATUS",
											"type": "String"
										},
										"sink": {
											"name": "STATUS",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CURR_MAX_DELTA_COL_VALUE",
											"type": "String"
										},
										"sink": {
											"name": "CURR_DELTA_VALUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SRC_DELTA_COL",
											"type": "String"
										},
										"sink": {
											"name": "DELTA_COL"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ETL_LOAD_CONTROL",
								"type": "DatasetReference",
								"parameters": {
									"AZ_STORAGE_TABLE": {
										"value": "@variables('V_ELT_METADATA_TABLE')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ETL_LOAD_CONTROL",
								"type": "DatasetReference",
								"parameters": {
									"AZ_STORAGE_TABLE": "EtlLoadControl"
								}
							}
						]
					},
					{
						"name": "Finally Raise Exception",
						"description": "If exception occurred then set status to FAILED in load control Table  ",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Exec ETL Framework",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Updt ELT Execution",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"EXEC_RUN_ID": {
									"value": "@pipeline().RunId",
									"type": "Expression"
								},
								"RUN_STATUS": "FAILED",
								"RUN_MESSAGE": {
									"value": "@{activity('Exec ETL Framework').Error.Message}",
									"type": "Expression"
								},
								"PREV_DELTA_VALUE": {
									"value": "NULL",
									"type": "Expression"
								},
								"CURR_DELTA_VALUE": {
									"value": "@variables('V_NEW_DELTA_VALUE')",
									"type": "Expression"
								},
								"JOB_NAME": {
									"value": "@pipeline().parameters.JOB_NAME",
									"type": "Expression"
								}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"JOB_NAME": {
						"type": "string",
						"defaultValue": "LOAD_CRADLEPOINT_REST_NET_DEVICES"
					}
				},
				"variables": {
					"V_NEW_DELTA_VALUE": {
						"type": "String"
					},
					"V_OUTPUT_MESSAGE": {
						"type": "String"
					},
					"V_ELT_METADATA_TABLE": {
						"type": "String",
						"defaultValue": "EltMetadataControl"
					},
					"V_ELT_LOADCONTROL_TABLE": {
						"type": "String",
						"defaultValue": "EltLoadControl"
					},
					"V_METADATA_DEF_PARTITION_KEY": {
						"type": "String",
						"defaultValue": "DEFAULT"
					},
					"V_RAISE_EXCEPTION": {
						"type": "Array"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:02Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DS_ETL_LOAD_CONTROL')]",
				"[concat(variables('factoryId'), '/pipelines/PL_ELT_FRAMEWORK_MAIN')]",
				"[concat(variables('factoryId'), '/pipelines/PL_Updt ELT Execution')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_ELT_FRAMEWORK_MAIN')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Ingest_by_src_type",
						"description": "Start the actual PULL from src to RDS-STAGE blob",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "Clean RDS if DEST_TYPE is not STAGE",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.SRC_TYPE",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "HDFS",
									"activities": [
										{
											"name": "PL_HDFS_MAIN",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_HDFS_MAIN",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"DELTA_CURR_MAX_VALUE": {
														"value": "@pipeline().parameters.CURR_MAX_DELTA_COL_VALUE",
														"type": "Expression"
													},
													"SRC_TBL_FILE_PATH": {
														"value": "@pipeline().parameters.SRC_TBL_FILE_PATH",
														"type": "Expression"
													},
													"SRC_DELTA_COL": {
														"value": "@pipeline().parameters.SRC_DELTA_COL",
														"type": "Expression"
													},
													"HDFS_PARTITION_COL_FORMAT": {
														"value": "@pipeline().parameters.HDFS_PARTITION_COL_FORMAT",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD_TYPE": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD_TYPE",
														"type": "Expression"
													},
													"ODS_LOC": {
														"value": "@pipeline().parameters.ODS_LOC",
														"type": "Expression"
													},
													"WINDOW_START_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_START_TIME_UTC",
														"type": "Expression"
													},
													"WINDOW_END_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
														"type": "Expression"
													},
													"DEST_TYPE": {
														"value": "@pipeline().parameters.DEST_TYPE",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													}
												}
											}
										},
										{
											"name": "Set V_SRC_COUNT_DERIVED",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "PL_HDFS_MAIN",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": "1"
											}
										},
										{
											"name": "Set IS_ERR_TO_RAISE to Y",
											"description": "This is to check if the failed flow is not recovered",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "PL_HDFS_MAIN",
													"dependencyConditions": [
														"Failed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": "Y"
											}
										},
										{
											"name": "Set IS_ERR_TO_RAISE to N",
											"description": "This is to check if the failed flow is not recovered",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Set V_SRC_COUNT_DERIVED",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": "N"
											}
										}
									]
								},
								{
									"value": "NTW_FTP",
									"activities": [
										{
											"name": "Copy from FTP",
											"description": "Copy data from FTP to RDS stage. Infact its a move from FTP to RDS stage. ",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Exec Fin File Checker",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "BinarySource",
													"storeSettings": {
														"type": "FtpReadSettings",
														"recursive": true,
														"wildcardFolderPath": {
															"value": "@{concat(pipeline().parameters.SRC_TBL_FILE_PATH)}",
															"type": "Expression"
														},
														"wildcardFileName": {
															"value": "@replace(pipeline().parameters.SRC_TBL_FILE_NAME_PATTERN, '.fin', '')",
															"type": "Expression"
														},
														"useBinaryTransfer": true,
														"deleteFilesAfterCompletion": true
													},
													"formatSettings": {
														"type": "BinaryReadSettings"
													}
												},
												"sink": {
													"type": "BinarySink",
													"storeSettings": {
														"type": "AzureBlobStorageWriteSettings"
													}
												},
												"enableStaging": false,
												"logStorageSettings": {
													"linkedServiceName": {
														"referenceName": "ls_az_stg_acc",
														"type": "LinkedServiceReference"
													},
													"path": {
														"value": "@concat('logs/', if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE/', pipeline().parameters.DEST_TBL)))",
														"type": "Expression"
													}
												},
												"dataIntegrationUnits": 2
											},
											"inputs": [
												{
													"referenceName": "NTW_FTP_Datasets",
													"type": "DatasetReference",
													"parameters": {
														"SRC_DATASET_PATH": {
															"value": "@{concat(pipeline().parameters.SRC_TBL_FILE_PATH)}",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "BLOB_Binary_Datasets",
													"type": "DatasetReference",
													"parameters": {
														"CONTAINER": {
															"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
															"type": "Expression"
														},
														"FOLDER_FILE": {
															"value": "@pipeline().parameters.DEST_TBL",
															"type": "Expression"
														}
													}
												}
											]
										},
										{
											"name": "Set V_SRC_DATA_COUNT for ftp",
											"description": "set the data written size to evaluate if  any src record was copied or not ",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Copy from FTP",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": {
													"value": "@string(activity('Copy from FTP').output.datawritten)",
													"type": "Expression"
												}
											}
										},
										{
											"name": "ARCHIVE FTP FILES",
											"description": "as its mv ie copy and delete from FTP to RDS. if 5 files and 4 copied 1 failed at src you would have only 1 file left. To Rerun Support need to copy from archive for the latest run",
											"type": "ExecutePipeline",
											"dependsOn": [
												{
													"activity": "Copy from FTP",
													"dependencyConditions": [
														"Completed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_ARCHIVER",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"RDS_STAGE_LOC": {
														"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													},
													"ID": {
														"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
														"type": "Expression"
													}
												}
											}
										},
										{
											"name": "Set isErr true",
											"description": "if any err in archival, set this flag and voice out the exception !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "ARCHIVE FTP FILES",
													"dependencyConditions": [
														"Failed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": {
													"value": "Y",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Set isErr true_and_archive_any_half_copied_files",
											"description": "if any err in FTPing, set this flag and voice out the exception !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "Copy from FTP",
													"dependencyConditions": [
														"Failed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": {
													"value": "Y",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Exec Fin File Checker",
											"description": "this checks if the fin file exists and throws error if otherwise !!",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_fin_FILE_CHECKER",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"SRC_TBL_FILE_PATH": {
														"value": "@{concat(pipeline().parameters.SRC_TBL_FILE_PATH)}",
														"type": "Expression"
													},
													"SRC_TBL_FILE_NAME_PATTERN": {
														"value": "@pipeline().parameters.SRC_TBL_FILE_NAME_PATTERN",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"ID": {
														"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "BLOB",
									"activities": [
										{
											"name": "BLOB 2 STG BLOB",
											"description": "copy data from blob to rds stage ",
											"type": "Copy",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "BinarySource",
													"storeSettings": {
														"type": "AzureBlobStorageReadSettings",
														"recursive": true,
														"modifiedDatetimeStart": {
															"value": "@pipeline().parameters.WINDOW_START_TIME_UTC",
															"type": "Expression"
														},
														"modifiedDatetimeEnd": {
															"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
															"type": "Expression"
														},
														"deleteFilesAfterCompletion": false
													},
													"formatSettings": {
														"type": "BinaryReadSettings"
													}
												},
												"sink": {
													"type": "BinarySink",
													"storeSettings": {
														"type": "AzureBlobStorageWriteSettings"
													}
												},
												"enableStaging": false,
												"validateDataConsistency": false
											},
											"inputs": [
												{
													"referenceName": "BLOB_Binary_Datasets",
													"type": "DatasetReference",
													"parameters": {
														"CONTAINER": {
															"value": "@variables('V_NW_EXP_IMPORT_CONTAINER')",
															"type": "Expression"
														},
														"FOLDER_FILE": {
															"value": "@pipeline().parameters.SRC_TBL_FILE_PATH",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_blob_sink_4_hdfs",
													"type": "DatasetReference",
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
															"type": "Expression"
														},
														"RDS_STAGE_FOLDER": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), pipeline().parameters.ODS_LOC, pipeline().parameters.DEST_TBL)",
															"type": "Expression"
														}
													}
												}
											]
										},
										{
											"name": "Set V_SRC_COUNT_DERIVED_4_BLOB",
											"description": "For BLOB, its not the row count but just the size of data written !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "BLOB 2 STG BLOB",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": {
													"value": "@string(activity('BLOB 2 STG BLOB').output.dataWritten)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "ORA_ELA_DB",
									"activities": [
										{
											"name": "ORA_ELA_2_AZ_COPY",
											"description": "Copy oracle ela to stage",
											"type": "Copy",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "OracleSource",
													"oracleReaderQuery": {
														"value": "@concat(pipeline().parameters.QRY, ' ', if(equals(pipeline().parameters.CURR_MAX_DELTA_COL_VALUE, 'NULL'), 'WHERE 1 = 1', concat(' WHERE ', pipeline().parameters.SRC_DELTA_COL, ' > ',replace(pipeline().parameters.CURR_MAX_DELTA_COL_VALUE_FORMAT,'###VALUE###',pipeline().parameters.CURR_MAX_DELTA_COL_VALUE)) ), if(equals('NULL', pipeline().parameters.SRC_CUSTOM_WHERE_CLAUSE), ' ', pipeline().parameters.SRC_CUSTOM_WHERE_CLAUSE))",
														"type": "Expression"
													},
													"partitionOption": "None",
													"queryTimeout": "02:00:00"
												},
												"sink": {
													"type": "DelimitedTextSink",
													"storeSettings": {
														"type": "AzureBlobStorageWriteSettings"
													},
													"formatSettings": {
														"type": "DelimitedTextWriteSettings",
														"quoteAllText": true,
														"fileExtension": ".txt"
													}
												},
												"enableStaging": false,
												"translator": {
													"type": "TabularTranslator",
													"typeConversion": true,
													"typeConversionSettings": {
														"allowDataTruncation": true,
														"treatBooleanAsNumber": false
													}
												}
											},
											"inputs": [
												{
													"referenceName": "ORA_ELA_Datasets",
													"type": "DatasetReference",
													"parameters": {}
												}
											],
											"outputs": [
												{
													"referenceName": "RDS_STAGE_CSV_DataSets",
													"type": "DatasetReference",
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
															"type": "Expression"
														},
														"RDS_STAGE_FILE_FOLDER": {
															"value": "@pipeline().parameters.DEST_TBL",
															"type": "Expression"
														}
													}
												}
											]
										},
										{
											"name": "Set V_SRC_COUNT_DERIVED FOR ORA ELA",
											"description": "SETS THE COUNT OF ROWS COPIED",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "ORA_ELA_2_AZ_COPY",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": {
													"value": "@STRING(activity('ORA_ELA_2_AZ_COPY').output.rowsCopied)",
													"type": "Expression"
												}
											}
										}
									]
								}
							],
							"defaultActivities": [
								{
									"name": "Set OUTPUT_MESSAGE 4 INVALID",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_OUTPUT_MESSAGE",
										"value": "Invalid SRC_TYPE in input. CASE sensitive. Allowed Values are \nHDFS | SYBASE_ENIQ | SYBASE_EDM | NTW_FTP | HDFS_EDGE | ORA_ELA"
									}
								}
							]
						}
					},
					{
						"name": "DEST is DBFS",
						"description": "if the DEST_TYPE is DBFS then all the loader notebook for ingesting to final tgt location/table",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Log Stage Completed Run Status",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@and(greater(int(variables('V_SRC_COUNT_DERIVED')),0), equals('DBFS', pipeline().parameters.DEST_TYPE))",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "LoadDBFSFromBlob",
									"description": "Call the databricks notebook loader to do copy from RDS stage to ODS or tgt table",
									"type": "DatabricksNotebook",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": {
											"value": "@variables('V_DBRICKS_LOADER_NTBK')",
											"type": "Expression"
										},
										"baseParameters": {
											"EXEC_RUN_ID": {
												"value": "@pipeline().parameters.EXEC_RUN_ID",
												"type": "Expression"
											},
											"RDS_STAGE_LOC": {
												"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
												"type": "Expression"
											},
											"RDS_STAGE_FILE_FOLDER": {
												"value": "@pipeline().parameters.DEST_TBL",
												"type": "Expression"
											},
											"SRC_COUNT_DERIVED": {
												"value": "@variables('V_SRC_COUNT_DERIVED')",
												"type": "Expression"
											},
											"METADATA_JSON": {
												"value": "@string(pipeline().parameters.METADATA_JSON)",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "Networth_DataBricks",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Log Success on both Control tables",
									"description": "Yay !! finally success flow. Update the metadata and load control table with success flow messages",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "LoadDBFSFromBlob",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Updt ELT Execution",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EXEC_RUN_ID": {
												"value": "@pipeline().parameters.EXEC_RUN_ID",
												"type": "Expression"
											},
											"RUN_STATUS": "SUCCESS",
											"RUN_MESSAGE": "Successfully loaded stage to dbricks",
											"PREV_DELTA_VALUE": {
												"value": "@pipeline().parameters.CURR_MAX_DELTA_COL_VALUE",
												"type": "Expression"
											},
											"CURR_DELTA_VALUE": {
												"value": "@if(or(equals(pipeline().parameters.SRC_TYPE, 'HDFS'), or(equals(pipeline().parameters.SRC_TYPE, 'NTW_FTP'), equals(pipeline().parameters.SRC_TYPE, 'BLOB'))), pipeline().parameters.WINDOW_END_TIME_UTC, string(activity('LoadDBFSFromBlob').output.runOutput))",
												"type": "Expression"
											},
											"JOB_NAME": {
												"value": "@pipeline().parameters.JOB_NAME",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Log Stage Completed Run Status",
						"description": "Log a record on to load control to indicate the stage copy completion",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Check for any is_err_to_raise",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_Updt ELT Execution",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"EXEC_RUN_ID": {
									"value": "@pipeline().parameters.EXEC_RUN_ID",
									"type": "Expression"
								},
								"RUN_STATUS": {
									"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'STAGE'), 'SUCCESS', 'INFO:: Cpy2Stage Completed')",
									"type": "Expression"
								},
								"RUN_MESSAGE": {
									"value": "@concat('INFO:: Cpy2Stage Completed : Row Count or File Size :: ', variables('V_SRC_COUNT_DERIVED') , ' :: staged  ', concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE', '/'), pipeline().parameters.DEST_TBL)",
									"type": "Expression"
								},
								"PREV_DELTA_VALUE": {
									"value": "@pipeline().parameters.CURR_MAX_DELTA_COL_VALUE",
									"type": "Expression"
								},
								"CURR_DELTA_VALUE": "NULL",
								"JOB_NAME": {
									"value": "@pipeline().parameters.JOB_NAME",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "DEST is just STAGE or ODS",
						"description": "If the DEST_TYPE is ODS or STAGE, where we dont want to spend money on Dbricks as its already ODS data from SRC.\n\nUse case would be \n  sync up hdfs table / schema to blob\n  DR for HDFS \n  IF No need for dedupe or audit fields or  delta table\n   ",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Log Stage Completed Run Status",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@AND(greater(int(variables('V_SRC_COUNT_DERIVED')),0),  EQUALS(pipeline().parameters.DEST_TYPE, 'ODS'))",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "set V_NEW_DELTA_VALUE_DIRECT_ODS",
									"description": "set the value for file based runs to be recorded against DELTA value on the metadata control table",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_NEW_DELTA_VALUE",
										"value": {
											"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Log Success on both Control tables_ 4 just stage",
									"description": "Yay !! Success flow update the metadata control with delta and log success entry in to the control tables.",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "msck repair",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_Updt ELT Execution",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"EXEC_RUN_ID": {
												"value": "@pipeline().parameters.EXEC_RUN_ID",
												"type": "Expression"
											},
											"RUN_STATUS": "SUCCESS",
											"RUN_MESSAGE": "Successfully loaded stage to ODS",
											"PREV_DELTA_VALUE": {
												"value": "@pipeline().parameters.CURR_MAX_DELTA_COL_VALUE",
												"type": "Expression"
											},
											"CURR_DELTA_VALUE": {
												"value": "@variables('V_NEW_DELTA_VALUE')",
												"type": "Expression"
											},
											"JOB_NAME": {
												"value": "@pipeline().parameters.JOB_NAME",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "msck repair",
									"description": "call msck repair as we didnot used dbfs to load to the ODS syncup.\nWatch for the cluster spin up time !! (cost too)",
									"type": "DatabricksNotebook",
									"dependsOn": [
										{
											"activity": "set V_NEW_DELTA_VALUE_DIRECT_ODS",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"notebookPath": {
											"value": "@variables('V_DBRICKS_MSCK_NTBK')",
											"type": "Expression"
										},
										"baseParameters": {
											"DEST_TBL": {
												"value": "@pipeline().parameters.DEST_TBL",
												"type": "Expression"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "ls_databricks_eniq_raw",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "Clean RDS if DEST_TYPE is not STAGE",
						"description": "Check for DEST_TYPE and prep for RDS_STAGE cleanup to avoid any dirty reads in the current  flow",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@and(equals(pipeline().parameters.DEST_TYPE, 'ODS'), not(equals(pipeline().parameters.LOAD_TYPE, 'TRUNC_LOAD_ODS')))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Clean RDS Staging",
									"description": "Start to cleanup the RDS Stage blob for clean start",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "PL_RDS_BLOB_CLEANER",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"RDS_STAGE_LOC": {
												"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
												"type": "Expression"
											},
											"RDS_STAGE_FOLDER": {
												"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), pipeline().parameters.ODS_LOC, pipeline().parameters.DEST_TBL)",
												"type": "Expression"
											},
											"SRC_TYPE": {
												"value": "@pipeline().parameters.SRC_TYPE",
												"type": "Expression"
											},
											"DEST_TYPE": {
												"value": "@pipeline().parameters.DEST_TYPE",
												"type": "Expression"
											}
										}
									}
								}
							]
						}
					},
					{
						"name": "Check for any is_err_to_raise",
						"description": "Checking if any err has occured in the copy to RDS flow",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Ingest_by_src_type",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('V_IS_ERR_TO_RAISE'), 'Y')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "set output_message for rds_stage copy failure",
									"description": "This is more like a err or info message to look upon",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_OUTPUT_MESSAGE",
										"value": "Either No File in staging to ingest to blob or src rec count is 0. Please check"
									}
								},
								{
									"name": "Raise Exception in RDS_STAGE copy",
									"description": "Please check the RDS_location and archive the files manually !!",
									"type": "AppendVariable",
									"dependsOn": [
										{
											"activity": "set output_message for rds_stage copy failure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_RAISE_EXCEPTION",
										"value": {
											"value": "@int(variables('V_OUTPUT_MESSAGE'))",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Execute PL_SRC_COUNT_ZERO",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Log Stage Completed Run Status",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_SRC_COUNT_ZERO_CHECK",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"SRC_COUNT_DERIVED": {
									"value": "@variables('V_SRC_COUNT_DERIVED')",
									"type": "Expression"
								}
							}
						}
					}
				],
				"concurrency": 5,
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"QRY": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TBL_FILE_PATH": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TBL": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DBFS_SAVE_MODE": {
						"type": "string",
						"defaultValue": "append"
					},
					"DBFS_COALESCE": {
						"type": "string",
						"defaultValue": "200"
					},
					"DBFS_PARTITION_BY": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"RDS_STAGE_LOC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"ODS_LOC": {
						"type": "string",
						"defaultValue": "nw-ods-stage/NotApplicable"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"RDS_STAGE_FILE_FOLDER": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DBFS_FILE_FORMAT": {
						"type": "string",
						"defaultValue": "DELTA"
					},
					"IS_AZ_AUDIT_COLS_2_ADD": {
						"type": "string",
						"defaultValue": "Y"
					},
					"SRC_DELTA_COL": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TBL_PK_CSV": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"RDS_STAGE_FILE_FORMAT": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_CUSTOM_WHERE_CLAUSE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_START_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_END_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"JOB_NAME": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"EXEC_RUN_ID": {
						"type": "string",
						"defaultValue": "@pipeline.runId"
					},
					"CURR_MAX_DELTA_COL_VALUE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"CURR_MAX_DELTA_COL_VALUE_FORMAT": {
						"type": "string",
						"defaultValue": "'###VALUE###'"
					},
					"LOAD_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"METADATA_JSON": {
						"type": "object",
						"defaultValue": "N"
					},
					"SRC_TBL_FILE_NAME_PATTERN": {
						"type": "string",
						"defaultValue": "*"
					},
					"HDFS_PARTITION_COL_FORMAT": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					}
				},
				"variables": {
					"V_DELTA_COND_DERVIED": {
						"type": "String"
					},
					"V_SRC_COUNT_DERIVED": {
						"type": "String",
						"defaultValue": "0"
					},
					"V_OUTPUT_MESSAGE": {
						"type": "String",
						"defaultValue": "SUCCESS"
					},
					"V_RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-rds-stage"
					},
					"V_NEW_DELTA_VALUE": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_RAISE_EXCEPTION": {
						"type": "Array"
					},
					"V_DBRICKS_LOADER_NTBK": {
						"type": "String",
						"defaultValue": "/app/dmt/network/data-ingestion-fwk/ntbk/LoadDBFSFromBlob"
					},
					"V_ODS_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-ods"
					},
					"V_NW_EXP_IMPORT_CONTAINER": {
						"type": "String",
						"defaultValue": "nw-exp-import"
					},
					"V_LOGS_CONTAINER": {
						"type": "String",
						"defaultValue": "logs"
					},
					"V_DBRICKS_MSCK_NTBK": {
						"type": "String",
						"defaultValue": "/app/dmt/network/data-ingestion-fwk/ntbk/dif-frmwrk-msck-repair"
					},
					"V_IS_ERR_TO_RAISE": {
						"type": "String",
						"defaultValue": "N"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:02Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_Updt ELT Execution')]",
				"[concat(variables('factoryId'), '/pipelines/PL_SRC_COUNT_ZERO_CHECK')]",
				"[concat(variables('factoryId'), '/linkedServices/Networth_DataBricks')]",
				"[concat(variables('factoryId'), '/linkedServices/ls_databricks_eniq_raw')]",
				"[concat(variables('factoryId'), '/pipelines/PL_RDS_BLOB_CLEANER')]",
				"[concat(variables('factoryId'), '/pipelines/PL_HDFS_MAIN')]",
				"[concat(variables('factoryId'), '/datasets/NTW_FTP_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/BLOB_Binary_Datasets')]",
				"[concat(variables('factoryId'), '/pipelines/PL_ARCHIVER')]",
				"[concat(variables('factoryId'), '/pipelines/PL_fin_FILE_CHECKER')]",
				"[concat(variables('factoryId'), '/datasets/ds_blob_sink_4_hdfs')]",
				"[concat(variables('factoryId'), '/datasets/ORA_ELA_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/RDS_STAGE_CSV_DataSets')]",
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_HDFS_MAIN')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Switch Based on PARTITION_THRESHOLD_TYPE",
						"type": "Switch",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.PARTITION_THRESHOLD_TYPE",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "DATE",
									"activities": [
										{
											"name": "Execute PL_HDFS_RETRIEVAL DATE",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_HDFS_RETRIEVAL",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"DELTA_CURR_MAX_VALUE": {
														"value": "@pipeline().parameters.DELTA_CURR_MAX_VALUE",
														"type": "Expression"
													},
													"SRC_TBL_FILE_PATH": {
														"value": "@pipeline().parameters.SRC_TBL_FILE_PATH",
														"type": "Expression"
													},
													"HDFS_PARTITION_COL_FORMAT": {
														"value": "@pipeline().parameters.HDFS_PARTITION_COL_FORMAT",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD_TYPE": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD_TYPE",
														"type": "Expression"
													},
													"ODS_LOC": {
														"value": "@pipeline().parameters.ODS_LOC",
														"type": "Expression"
													},
													"WINDOW_START_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_START_TIME_UTC",
														"type": "Expression"
													},
													"WINDOW_END_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
														"type": "Expression"
													},
													"DEST_TYPE": {
														"value": "@pipeline().parameters.DEST_TYPE",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													},
													"SRC_DELTA_COL": {
														"value": "@pipeline().parameters.SRC_DELTA_COL",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "NULL",
									"activities": [
										{
											"name": "HDFS_PULL_FRM_PRIMARY_WEBHDFS",
											"description": "Pull the files from HDFS cluster using timebased water marking !!",
											"type": "Copy",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "BinarySource",
													"storeSettings": {
														"type": "HdfsReadSettings",
														"recursive": true,
														"modifiedDatetimeStart": {
															"value": "@{pipeline().parameters.WINDOW_START_TIME_UTC}",
															"type": "Expression"
														},
														"modifiedDatetimeEnd": {
															"value": "@{pipeline().parameters.WINDOW_END_TIME_UTC}",
															"type": "Expression"
														},
														"wildcardFolderPath": {
															"value": "@{concat(pipeline().parameters.SRC_TBL_FILE_PATH)}",
															"type": "Expression"
														},
														"wildcardFileName": "*"
													},
													"formatSettings": {
														"type": "BinaryReadSettings"
													}
												},
												"sink": {
													"type": "BinarySink",
													"storeSettings": {
														"type": "AzureBlobStorageWriteSettings"
													}
												},
												"enableStaging": false,
												"validateDataConsistency": false
											},
											"inputs": [
												{
													"referenceName": "HDFS_Datasets",
													"type": "DatasetReference",
													"parameters": {}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_blob_sink_4_hdfs",
													"type": "DatasetReference",
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
															"type": "Expression"
														},
														"RDS_STAGE_FOLDER": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), pipeline().parameters.ODS_LOC, pipeline().parameters.DEST_TBL)",
															"type": "Expression"
														}
													}
												}
											]
										},
										{
											"name": "Set V_SRC_COUNT_DERIVED",
											"description": "For HDFS, its not the row count but just the size of data written !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "HDFS_PULL_FRM_PRIMARY_WEBHDFS",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": {
													"value": "@string(activity('HDFS_PULL_FRM_PRIMARY_WEBHDFS').output.dataWritten)",
													"type": "Expression"
												}
											}
										},
										{
											"name": "ARCHIVE HDFS FILES",
											"description": "as its mv ie copy and delete from FTP to RDS. if 5 files and 4 copied 1 failed at src you would have only 1 file left. To Rerun Support need to copy from archive for the latest run",
											"type": "ExecutePipeline",
											"dependsOn": [
												{
													"activity": "Set V_SRC_COUNT_DERIVED",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_ARCHIVER",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"RDS_STAGE_LOC": {
														"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													}
												}
											}
										},
										{
											"name": "HDFS_PULL_FRM_SECONDARY_WEBHDFS",
											"description": "Pull the files from HDFS cluster using timebased water marking !!",
											"type": "Copy",
											"dependsOn": [
												{
													"activity": "Set IS_ERR_TO_RAISE to Y",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "BinarySource",
													"storeSettings": {
														"type": "HdfsReadSettings",
														"recursive": true,
														"modifiedDatetimeStart": {
															"value": "@{pipeline().parameters.WINDOW_START_TIME_UTC}",
															"type": "Expression"
														},
														"modifiedDatetimeEnd": {
															"value": "@{pipeline().parameters.WINDOW_END_TIME_UTC}",
															"type": "Expression"
														},
														"wildcardFolderPath": {
															"value": "@{concat(pipeline().parameters.SRC_TBL_FILE_PATH)}",
															"type": "Expression"
														},
														"wildcardFileName": "*"
													},
													"formatSettings": {
														"type": "BinaryReadSettings"
													}
												},
												"sink": {
													"type": "BinarySink",
													"storeSettings": {
														"type": "AzureBlobStorageWriteSettings"
													}
												},
												"enableStaging": false,
												"validateDataConsistency": false
											},
											"inputs": [
												{
													"referenceName": "HDFS_Secondary_Datasets",
													"type": "DatasetReference",
													"parameters": {}
												}
											],
											"outputs": [
												{
													"referenceName": "ds_blob_sink_4_hdfs",
													"type": "DatasetReference",
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
															"type": "Expression"
														},
														"RDS_STAGE_FOLDER": {
															"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), pipeline().parameters.ODS_LOC, pipeline().parameters.DEST_TBL)",
															"type": "Expression"
														}
													}
												}
											]
										},
										{
											"name": "ARCHIVE HDFS FILES_FRM_SECONDARY",
											"description": "as its mv ie copy and delete from FTP to RDS. if 5 files and 4 copied 1 failed at src you would have only 1 file left. To Rerun Support need to copy from archive for the latest run",
											"type": "ExecutePipeline",
											"dependsOn": [
												{
													"activity": "Set V_SRC_COUNT_DERIVED_from HA",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_ARCHIVER",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"RDS_STAGE_LOC": {
														"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													}
												}
											}
										},
										{
											"name": "Set IS_ERR_TO_RAISE to Y",
											"description": "This is to check if the failed flow is not recovered",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "HDFS_PULL_FRM_PRIMARY_WEBHDFS",
													"dependencyConditions": [
														"Failed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": "Y"
											}
										},
										{
											"name": "Set IS_ERR_TO_RAISE to N",
											"description": "Yay !! Recovery flow is successful  !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "ARCHIVE HDFS FILES_FRM_SECONDARY",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_IS_ERR_TO_RAISE",
												"value": "N"
											}
										},
										{
											"name": "Set V_SRC_COUNT_DERIVED_from HA",
											"description": "For HDFS, its not the row count but just the size of data written !!",
											"type": "SetVariable",
											"dependsOn": [
												{
													"activity": "HDFS_PULL_FRM_SECONDARY_WEBHDFS",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_SRC_COUNT_DERIVED",
												"value": {
													"value": "@string(activity('HDFS_PULL_FRM_SECONDARY_WEBHDFS').output.dataWritten)",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Execute PL_SRC_COUNT_ZERO_CHECK",
											"type": "ExecutePipeline",
											"dependsOn": [
												{
													"activity": "ARCHIVE HDFS FILES",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_SRC_COUNT_ZERO_CHECK",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"SRC_COUNT_DERIVED": {
														"value": "@variables('V_SRC_COUNT_DERIVED')",
														"type": "Expression"
													}
												}
											}
										},
										{
											"name": "Execute PL_SRC_COUNT_ZERO_CHECK_1",
											"type": "ExecutePipeline",
											"dependsOn": [
												{
													"activity": "Set IS_ERR_TO_RAISE to N",
													"dependencyConditions": [
														"Succeeded"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_SRC_COUNT_ZERO_CHECK",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"SRC_COUNT_DERIVED": {
														"value": "@variables('V_SRC_COUNT_DERIVED')",
														"type": "Expression"
													}
												}
											}
										}
									]
								},
								{
									"value": "TIMESTAMP",
									"activities": [
										{
											"name": "Execute PL_HDFS_RETRIEVAL TIMESTAMP",
											"type": "ExecutePipeline",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"pipeline": {
													"referenceName": "PL_HDFS_RETRIEVAL",
													"type": "PipelineReference"
												},
												"waitOnCompletion": true,
												"parameters": {
													"DELTA_CURR_MAX_VALUE": {
														"value": "@pipeline().parameters.DELTA_CURR_MAX_VALUE",
														"type": "Expression"
													},
													"SRC_TBL_FILE_PATH": {
														"value": "@pipeline().parameters.SRC_TBL_FILE_PATH",
														"type": "Expression"
													},
													"HDFS_PARTITION_COL_FORMAT": {
														"value": "@pipeline().parameters.HDFS_PARTITION_COL_FORMAT",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD",
														"type": "Expression"
													},
													"PARTITION_THRESHOLD_TYPE": {
														"value": "@pipeline().parameters.PARTITION_THRESHOLD_TYPE",
														"type": "Expression"
													},
													"ODS_LOC": {
														"value": "@pipeline().parameters.ODS_LOC",
														"type": "Expression"
													},
													"WINDOW_START_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_START_TIME_UTC",
														"type": "Expression"
													},
													"WINDOW_END_TIME_UTC": {
														"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
														"type": "Expression"
													},
													"DEST_TYPE": {
														"value": "@pipeline().parameters.DEST_TYPE",
														"type": "Expression"
													},
													"DEST_TBL": {
														"value": "@pipeline().parameters.DEST_TBL",
														"type": "Expression"
													},
													"SRC_TYPE": {
														"value": "@pipeline().parameters.SRC_TYPE",
														"type": "Expression"
													},
													"SRC_DELTA_COL": {
														"value": "@pipeline().parameters.SRC_DELTA_COL",
														"type": "Expression"
													}
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Check for any is_err_to_raise",
						"description": "Checking if any err has occured in the copy to RDS flow",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Switch Based on PARTITION_THRESHOLD_TYPE",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('V_IS_ERR_TO_RAISE'), 'Y')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "set output_message for rds_stage copy failure",
									"description": "This is more like a err or info message to look upon",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_OUTPUT_MESSAGE",
										"value": "Either No File in staging to ingest to blob or src rec count is 0. Please check"
									}
								},
								{
									"name": "Raise Exception in RDS_STAGE copy",
									"description": "Please check the RDS_location and archive the files manually !!",
									"type": "AppendVariable",
									"dependsOn": [
										{
											"activity": "set output_message for rds_stage copy failure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_RAISE_EXCEPTION",
										"value": {
											"value": "@int(variables('V_OUTPUT_MESSAGE'))",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"DELTA_CURR_MAX_VALUE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TBL_FILE_PATH": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_DELTA_COL": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"HDFS_PARTITION_COL_FORMAT": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"ODS_LOC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_START_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_END_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TBL": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					}
				},
				"variables": {
					"V_START_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_TEMP_START_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_END_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_STOP_LOOP": {
						"type": "String",
						"defaultValue": "false"
					},
					"V_IS_ERR_TO_RAISE": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-rds-stage"
					},
					"V_SRC_COUNT_DERIVED": {
						"type": "String",
						"defaultValue": "0"
					},
					"V_ODS_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-ods"
					},
					"V_OUTPUT_MESSAGE": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_RAISE_EXCEPTION": {
						"type": "Array",
						"defaultValue": [
							"NULL"
						]
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:01Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_HDFS_RETRIEVAL')]",
				"[concat(variables('factoryId'), '/datasets/HDFS_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/ds_blob_sink_4_hdfs')]",
				"[concat(variables('factoryId'), '/pipelines/PL_ARCHIVER')]",
				"[concat(variables('factoryId'), '/datasets/HDFS_Secondary_Datasets')]",
				"[concat(variables('factoryId'), '/pipelines/PL_SRC_COUNT_ZERO_CHECK')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_HDFS_RETRIEVAL')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until END_PARTITION",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Switch set V_END_PARTITION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('V_STOP_LOOP'),'true')",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "If V_START_PART is less than V_END_PART",
									"type": "IfCondition",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"expression": {
											"value": "@lessOrEquals(variables('V_START_PARTITION'), variables('V_END_PARTITION'))",
											"type": "Expression"
										},
										"ifFalseActivities": [
											{
												"name": "Set V_LOOP_REPEAT_True",
												"type": "SetVariable",
												"dependsOn": [],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_STOP_LOOP",
													"value": {
														"value": "true",
														"type": "Expression"
													}
												}
											}
										],
										"ifTrueActivities": [
											{
												"name": "HDFS_PULL_FRM_PRIMARY_WEBHDFS_PARTITION_FORMAT",
												"type": "Copy",
												"dependsOn": [],
												"policy": {
													"timeout": "7.00:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"source": {
														"type": "BinarySource",
														"storeSettings": {
															"type": "HdfsReadSettings",
															"deleteFilesAfterCompletion": false,
															"recursive": true,
															"modifiedDatetimeStart": {
																"value": "@pipeline().parameters.WINDOW_START_TIME_UTC",
																"type": "Expression"
															},
															"modifiedDatetimeEnd": {
																"value": "@pipeline().parameters.WINDOW_END_TIME_UTC",
																"type": "Expression"
															},
															"wildcardFolderPath": {
																"value": "@replace(concat(pipeline().parameters.SRC_TBL_FILE_PATH,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')) ,'\\','')",
																"type": "Expression"
															}
														},
														"formatSettings": {
															"type": "BinaryReadSettings"
														}
													},
													"sink": {
														"type": "BinarySink",
														"storeSettings": {
															"type": "AzureBlobStorageWriteSettings",
															"copyBehavior": "PreserveHierarchy"
														}
													},
													"enableStaging": false
												},
												"inputs": [
													{
														"referenceName": "HDFS_Datasets",
														"type": "DatasetReference",
														"parameters": {}
													}
												],
												"outputs": [
													{
														"referenceName": "ds_blob_sink_4_hdfs",
														"type": "DatasetReference",
														"parameters": {
															"RDS_STAGE_LOC": {
																"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
																"type": "Expression"
															},
															"RDS_STAGE_FOLDER": {
																"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), concat(pipeline().parameters.ODS_LOC,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')), concat(pipeline().parameters.DEST_TBL,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')))",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "Set V_STOP_LOOP_On_Fail",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "HDFS_PULL_FRM_PRIMARY_WEBHDFS_PARTITION_FORMAT",
														"dependencyConditions": [
															"Failed"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_STOP_LOOP",
													"value": {
														"value": "true",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set V_STOP_LOOP_On_Success_FRM_SECONDARY",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Set V_SRC_COUNT_DERIVED_FRM_SECONDARY",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_STOP_LOOP",
													"value": {
														"value": "false",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Increment V_TEMP_SRC_COUNT_DERIVED",
												"description": "For HDFS, its not the row count but just the size of data written !!",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "HDFS_PULL_FRM_PRIMARY_WEBHDFS_PARTITION_FORMAT",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_TEMP_SRC_COUNT_DERIVED",
													"value": {
														"value": "@{add(activity('HDFS_PULL_FRM_PRIMARY_WEBHDFS_PARTITION_FORMAT').output.dataWritten,int(variables('V_SRC_COUNT_DERIVED')))}",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set V_SRC_COUNT_DERIVED_FRM_SECONDARY",
												"description": "For HDFS, its not the row count but just the size of data written !!",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Increment V_TEMP_SRC_COUNT_DERIVED_FRM_SECONDARY",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_SRC_COUNT_DERIVED",
													"value": {
														"value": "@variables('V_TEMP_SRC_COUNT_DERIVED')",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Switch set NEXT V_START_PARTITION",
												"type": "Switch",
												"dependsOn": [
													{
														"activity": "Set V_STOP_LOOP_On_Success_copy1",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"on": {
														"value": "@variables('V_PARTITION_THRESHOLD_ARR')[2]",
														"type": "Expression"
													},
													"cases": [
														{
															"value": "DAY",
															"activities": [
																{
																	"name": "Increment V_TEMP_START_PARTITION DAY",
																	"type": "SetVariable",
																	"dependsOn": [],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_TEMP_START_PARTITION",
																		"value": {
																			"value": "@adddays(variables('V_START_PARTITION'), 1, pipeline().parameters.HDFS_PARTITION_COL_FORMAT)",
																			"type": "Expression"
																		}
																	}
																},
																{
																	"name": "Set NEXT V_START_PARTITION DAY",
																	"type": "SetVariable",
																	"dependsOn": [
																		{
																			"activity": "Increment V_TEMP_START_PARTITION DAY",
																			"dependencyConditions": [
																				"Succeeded"
																			]
																		}
																	],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_START_PARTITION",
																		"value": {
																			"value": "@variables('V_TEMP_START_PARTITION')",
																			"type": "Expression"
																		}
																	}
																}
															]
														},
														{
															"value": "MINS",
															"activities": [
																{
																	"name": "Increment NEXT V_TEMP_START_PARTITION MINS",
																	"type": "SetVariable",
																	"dependsOn": [],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_TEMP_START_PARTITION",
																		"value": {
																			"value": "@replace(addMinutes(replace(variables('V_START_PARTITION'),'%3A',':'),int(variables('V_PARTITION_THRESHOLD_ARR')[1]), pipeline().parameters.HDFS_PARTITION_COL_FORMAT),':','%3A')",
																			"type": "Expression"
																		}
																	}
																},
																{
																	"name": "Set NEXT V_START_PARTITION MINS",
																	"type": "SetVariable",
																	"dependsOn": [
																		{
																			"activity": "Increment NEXT V_TEMP_START_PARTITION MINS",
																			"dependencyConditions": [
																				"Succeeded"
																			]
																		}
																	],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_START_PARTITION",
																		"value": {
																			"value": "@variables('V_TEMP_START_PARTITION')",
																			"type": "Expression"
																		}
																	}
																}
															]
														}
													]
												}
											},
											{
												"name": "HDFS_PULL_FRM_SECONDARY_WEBHDFS_PARTITION_FORMAT",
												"description": "Pull the files from HDFS cluster using timebased water marking !!",
												"type": "Copy",
												"dependsOn": [
													{
														"activity": "Set V_STOP_LOOP_On_Fail",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"policy": {
													"timeout": "7.00:00:00",
													"retry": 0,
													"retryIntervalInSeconds": 30,
													"secureOutput": false,
													"secureInput": false
												},
												"userProperties": [],
												"typeProperties": {
													"source": {
														"type": "BinarySource",
														"storeSettings": {
															"type": "HdfsReadSettings",
															"deleteFilesAfterCompletion": false,
															"recursive": true,
															"modifiedDatetimeStart": {
																"value": "@{pipeline().parameters.WINDOW_START_TIME_UTC}",
																"type": "Expression"
															},
															"modifiedDatetimeEnd": {
																"value": "@{pipeline().parameters.WINDOW_END_TIME_UTC}",
																"type": "Expression"
															},
															"wildcardFolderPath": {
																"value": "@replace(concat(pipeline().parameters.SRC_TBL_FILE_PATH,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')) ,'\\','')",
																"type": "Expression"
															}
														},
														"formatSettings": {
															"type": "BinaryReadSettings"
														}
													},
													"sink": {
														"type": "BinarySink",
														"storeSettings": {
															"type": "AzureBlobStorageWriteSettings"
														}
													},
													"enableStaging": false,
													"validateDataConsistency": false
												},
												"inputs": [
													{
														"referenceName": "HDFS_Secondary_Datasets",
														"type": "DatasetReference",
														"parameters": {}
													}
												],
												"outputs": [
													{
														"referenceName": "ds_blob_sink_4_hdfs",
														"type": "DatasetReference",
														"parameters": {
															"RDS_STAGE_LOC": {
																"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))",
																"type": "Expression"
															},
															"RDS_STAGE_FOLDER": {
																"value": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), concat(pipeline().parameters.ODS_LOC,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')), concat(pipeline().parameters.DEST_TBL,'/',pipeline().parameters.SRC_DELTA_COL,'=',variables('V_START_PARTITION')))",
																"type": "Expression"
															}
														}
													}
												]
											},
											{
												"name": "ARCHIVE HDFS FILES",
												"description": "as its mv ie copy and delete from FTP to RDS. if 5 files and 4 copied 1 failed at src you would have only 1 file left. To Rerun Support need to copy from archive for the latest run",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Switch set NEXT V_START_PARTITION",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"pipeline": {
														"referenceName": "PL_ARCHIVER",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
															"type": "Expression"
														},
														"DEST_TBL": {
															"value": "@pipeline().parameters.DEST_TBL",
															"type": "Expression"
														},
														"SRC_TYPE": {
															"value": "@pipeline().parameters.SRC_TYPE",
															"type": "Expression"
														}
													}
												}
											},
											{
												"name": "Increment V_TEMP_SRC_COUNT_DERIVED_FRM_SECONDARY",
												"description": "For HDFS, its not the row count but just the size of data written !!",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "HDFS_PULL_FRM_SECONDARY_WEBHDFS_PARTITION_FORMAT",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_TEMP_SRC_COUNT_DERIVED",
													"value": {
														"value": "@{add(activity('HDFS_PULL_FRM_SECONDARY_WEBHDFS_PARTITION_FORMAT').output.dataWritten,int(variables('V_SRC_COUNT_DERIVED')))}",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set V_STOP_LOOP_On_Fail_FRM_SECONDARY",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "HDFS_PULL_FRM_SECONDARY_WEBHDFS_PARTITION_FORMAT",
														"dependencyConditions": [
															"Failed"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_STOP_LOOP",
													"value": {
														"value": "true",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set V_SRC_COUNT_DERIVED_copy1",
												"description": "For HDFS, its not the row count but just the size of data written !!",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Increment V_TEMP_SRC_COUNT_DERIVED",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_SRC_COUNT_DERIVED",
													"value": {
														"value": "@variables('V_TEMP_SRC_COUNT_DERIVED')",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Set V_STOP_LOOP_On_Success_copy1",
												"type": "SetVariable",
												"dependsOn": [
													{
														"activity": "Set V_SRC_COUNT_DERIVED_copy1",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"variableName": "V_STOP_LOOP",
													"value": {
														"value": "false",
														"type": "Expression"
													}
												}
											},
											{
												"name": "Switch set NEXT V_START_PARTITION_FRM_SECONDARY",
												"type": "Switch",
												"dependsOn": [
													{
														"activity": "Set V_STOP_LOOP_On_Success_FRM_SECONDARY",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"on": {
														"value": "@variables('V_PARTITION_THRESHOLD_ARR')[2]",
														"type": "Expression"
													},
													"cases": [
														{
															"value": "DAY",
															"activities": [
																{
																	"name": "Increment V_TEMP_START_PARTITION DAY_copy1",
																	"type": "SetVariable",
																	"dependsOn": [],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_TEMP_START_PARTITION",
																		"value": {
																			"value": "@adddays(variables('V_START_PARTITION'), 1, pipeline().parameters.HDFS_PARTITION_COL_FORMAT)",
																			"type": "Expression"
																		}
																	}
																},
																{
																	"name": "Set NEXT V_START_PARTITION DAY_copy1",
																	"type": "SetVariable",
																	"dependsOn": [
																		{
																			"activity": "Increment V_TEMP_START_PARTITION DAY_copy1",
																			"dependencyConditions": [
																				"Succeeded"
																			]
																		}
																	],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_START_PARTITION",
																		"value": {
																			"value": "@variables('V_TEMP_START_PARTITION')",
																			"type": "Expression"
																		}
																	}
																}
															]
														},
														{
															"value": "MINS",
															"activities": [
																{
																	"name": "Increment NEXT V_TEMP_START_PARTITION MINS_copy1",
																	"type": "SetVariable",
																	"dependsOn": [],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_TEMP_START_PARTITION",
																		"value": {
																			"value": "@replace(addMinutes(replace(variables('V_START_PARTITION'),'%3A',':'),int(variables('V_PARTITION_THRESHOLD_ARR')[1]), pipeline().parameters.HDFS_PARTITION_COL_FORMAT),':','%3A')",
																			"type": "Expression"
																		}
																	}
																},
																{
																	"name": "Set NEXT V_START_PARTITION MINS_copy1",
																	"type": "SetVariable",
																	"dependsOn": [
																		{
																			"activity": "Increment NEXT V_TEMP_START_PARTITION MINS_copy1",
																			"dependencyConditions": [
																				"Succeeded"
																			]
																		}
																	],
																	"userProperties": [],
																	"typeProperties": {
																		"variableName": "V_START_PARTITION",
																		"value": {
																			"value": "@variables('V_TEMP_START_PARTITION')",
																			"type": "Expression"
																		}
																	}
																}
															]
														}
													]
												}
											},
											{
												"name": "ARCHIVE HDFS FILES_FRM_SECONDARY",
												"description": "as its mv ie copy and delete from FTP to RDS. if 5 files and 4 copied 1 failed at src you would have only 1 file left. To Rerun Support need to copy from archive for the latest run",
												"type": "ExecutePipeline",
												"dependsOn": [
													{
														"activity": "Switch set NEXT V_START_PARTITION_FRM_SECONDARY",
														"dependencyConditions": [
															"Succeeded"
														]
													}
												],
												"userProperties": [],
												"typeProperties": {
													"pipeline": {
														"referenceName": "PL_ARCHIVER",
														"type": "PipelineReference"
													},
													"waitOnCompletion": true,
													"parameters": {
														"RDS_STAGE_LOC": {
															"value": "@concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE')",
															"type": "Expression"
														},
														"DEST_TBL": {
															"value": "@pipeline().parameters.DEST_TBL",
															"type": "Expression"
														},
														"SRC_TYPE": {
															"value": "@pipeline().parameters.SRC_TYPE",
															"type": "Expression"
														}
													}
												}
											}
										]
									}
								},
								{
									"name": "Set V_STOP_LOOP_On_Fail_From_HA_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "If V_START_PART is less than V_END_PART",
											"dependencyConditions": [
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_STOP_LOOP",
										"value": {
											"value": "true",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Execute PL_SRC_COUNT_ZERO_CHECK",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Until END_PARTITION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "PL_SRC_COUNT_ZERO_CHECK",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"SRC_COUNT_DERIVED": {
									"value": "@variables('V_SRC_COUNT_DERIVED')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Set V_PARTITION_THRESHOLD_ARR",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "V_PARTITION_THRESHOLD_ARR",
							"value": {
								"value": "@split(pipeline().parameters.PARTITION_THRESHOLD,'###')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Switch set V_START_PARTITION",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "If V_PARTITION_THRESHOLD_ARR length is 3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@variables('V_PARTITION_THRESHOLD_ARR')[2]",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "DAY",
									"activities": [
										{
											"name": "Set V_START_PARTITION DAY",
											"type": "SetVariable",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_START_PARTITION",
												"value": {
													"value": "@convertTimeZone(adddays(utcnow(),int(concat('-',variables('V_PARTITION_THRESHOLD_ARR')[0]))), 'UTC', 'Eastern Standard Time',pipeline().parameters.HDFS_PARTITION_COL_FORMAT)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "MINS",
									"activities": [
										{
											"name": "Set V_START_PARTITION MINS",
											"type": "SetVariable",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_START_PARTITION",
												"value": {
													"value": "@replace(concat(addDays(convertTimeZone(utcnow(),'UTC','Eastern Standard Time'),sub(int(concat('-',variables('V_PARTITION_THRESHOLD_ARR')[0])),1), 'yyyy-MM-dd'),' 00:00:00'),':','%3A')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "If V_PARTITION_THRESHOLD_ARR length is 3",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Set V_PARTITION_THRESHOLD_ARR",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(length(variables('V_PARTITION_THRESHOLD_ARR')),3)",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Switch set V_END_PARTITION",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "Switch set V_START_PARTITION",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@variables('V_PARTITION_THRESHOLD_ARR')[2]",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "DAY",
									"activities": [
										{
											"name": "Set V_END_PARTITION",
											"type": "SetVariable",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_END_PARTITION",
												"value": {
													"value": "@convertTimeZone(adddays(utcnow(),-1), 'UTC', 'Eastern Standard Time', pipeline().parameters.HDFS_PARTITION_COL_FORMAT)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "MINS",
									"activities": [
										{
											"name": "Set V_END_PARTITION MINS",
											"type": "SetVariable",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_END_PARTITION",
												"value": {
													"value": "@replace(addMinutes(convertTimeZone(utcnow(), 'UTC', 'Eastern Standard Time', 'yyyy-MM-dd'),int(concat('-',variables('V_PARTITION_THRESHOLD_ARR')[1])),pipeline().parameters.HDFS_PARTITION_COL_FORMAT),':','%3A')",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"DELTA_CURR_MAX_VALUE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TBL_FILE_PATH": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"HDFS_PARTITION_COL_FORMAT": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"PARTITION_THRESHOLD_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"ODS_LOC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_START_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"WINDOW_END_TIME_UTC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"DEST_TBL": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"SRC_DELTA_COL": {
						"type": "string",
						"defaultValue": "NULL"
					}
				},
				"variables": {
					"V_START_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_TEMP_START_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_END_PARTITION": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_STOP_LOOP": {
						"type": "String",
						"defaultValue": "false"
					},
					"V_IS_ERR_TO_RAISE": {
						"type": "String"
					},
					"V_RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-rds-stage"
					},
					"V_SRC_COUNT_DERIVED": {
						"type": "String",
						"defaultValue": "0"
					},
					"V_ODS_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-ods"
					},
					"V_TEMP_SRC_COUNT_DERIVED": {
						"type": "String",
						"defaultValue": "0"
					},
					"V_PARTITION_THRESHOLD_ARR": {
						"type": "Array",
						"defaultValue": [
							"NULL"
						]
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:01Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/PL_SRC_COUNT_ZERO_CHECK')]",
				"[concat(variables('factoryId'), '/datasets/HDFS_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/ds_blob_sink_4_hdfs')]",
				"[concat(variables('factoryId'), '/datasets/HDFS_Secondary_Datasets')]",
				"[concat(variables('factoryId'), '/pipelines/PL_ARCHIVER')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_RDS_BLOB_CLEANER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Get Meta for RDS or ODS Folder",
						"description": "get ls output of RDS stage to know if we need to call delete via DFS API or not ",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "ds_blob_sink_4_hdfs",
								"type": "DatasetReference",
								"parameters": {
									"RDS_STAGE_LOC": {
										"value": "@pipeline().parameters.RDS_STAGE_LOC",
										"type": "Expression"
									},
									"RDS_STAGE_FOLDER": {
										"value": "@pipeline().parameters.RDS_STAGE_FOLDER",
										"type": "Expression"
									}
								}
							},
							"fieldList": [
								"exists",
								"itemName",
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "BinaryReadSettings"
							}
						}
					},
					{
						"name": "If folder exists DELETE via DFS api",
						"description": "call delete if ls -lrt resulted in child items ",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get Meta for RDS or ODS Folder",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@activity('Get Meta for RDS or ODS Folder').output.exists",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "delete rds",
									"description": "invoke deletion API for the specified folder and log the same !!",
									"type": "Delete",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataset": {
											"referenceName": "ds_4_deletion",
											"type": "DatasetReference",
											"parameters": {
												"container": {
													"value": "@pipeline().parameters.RDS_STAGE_LOC",
													"type": "Expression"
												},
												"path": {
													"value": "@pipeline().parameters.RDS_STAGE_FOLDER",
													"type": "Expression"
												}
											}
										},
										"logStorageSettings": {
											"linkedServiceName": {
												"referenceName": "ls_az_stg_acc",
												"type": "LinkedServiceReference"
											},
											"path": {
												"value": "@concat(variables('V_LOGS_CONTAINER') ,'/', pipeline().parameters.SRC_TYPE, '/', pipeline().parameters.RDS_STAGE_LOC, '/', pipeline().parameters.RDS_STAGE_FOLDER)",
												"type": "Expression"
											}
										},
										"enableLogging": true,
										"storeSettings": {
											"type": "AzureBlobFSReadSettings",
											"recursive": true
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"RDS_STAGE_LOC": {
						"type": "string",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-rds-stage/HDFS-STAGE"
					},
					"RDS_STAGE_FOLDER": {
						"type": "string",
						"defaultValue": "default.address_name_link_adf"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "HDFS"
					},
					"DEST_TYPE": {
						"type": "string",
						"defaultValue": "NA"
					}
				},
				"variables": {
					"V_RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-rds-stage"
					},
					"V_LOGS_CONTAINER": {
						"type": "String",
						"defaultValue": "logs"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/ds_blob_sink_4_hdfs')]",
				"[concat(variables('factoryId'), '/datasets/ds_4_deletion')]",
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_SRC_COUNT_ZERO_CHECK')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "If src rec count is 0",
						"description": "If no src record was put on to RDS-STAGE then lets voice out to load control and abort the flow",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(int(pipeline().parameters.SRC_COUNT_DERIVED),0)",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "set output_message 4 rec count 0",
									"description": "This is more like a err or info message to look upon",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_OUTPUT_MESSAGE",
										"value": "Either No File in staging to ingest to blob or src rec count is 0. Please check."
									}
								},
								{
									"name": "Raise Exception Err_No_Src_Record_loaded",
									"description": "No Records :( hence marking the job for Failure !!",
									"type": "AppendVariable",
									"dependsOn": [
										{
											"activity": "set output_message 4 rec count 0",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_RAISE_EXCEPTION",
										"value": {
											"value": "@int(variables('V_OUTPUT_MESSAGE'))",
											"type": "Expression"
										}
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SRC_COUNT_DERIVED": {
						"type": "string",
						"defaultValue": "0"
					}
				},
				"variables": {
					"V_SRC_COUNT_DERIVED": {
						"type": "String",
						"defaultValue": "0"
					},
					"V_OUTPUT_MESSAGE": {
						"type": "String",
						"defaultValue": "NULL"
					},
					"V_RAISE_EXCEPTION": {
						"type": "Array",
						"defaultValue": [
							"NULL"
						]
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:27:59Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_UPDT_ELT_EXECUTION')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Update EDA_EDL Control tables",
						"description": "decide to update the feed tables and the metadata control with SUCCESS and not for FAILED ",
						"type": "Switch",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.RUN_STATUS",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "FAILED",
									"activities": [
										{
											"name": "Raise_Exception_Finally",
											"description": "Call Raise Exception we got the FAILED status",
											"type": "AppendVariable",
											"dependsOn": [
												{
													"activity": "Update EDA_EDL Feed Tables on Failure",
													"dependencyConditions": [
														"Completed"
													]
												}
											],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_EXCEPTION_ARR",
												"value": {
													"value": "@array(pipeline().parameters.RUN_MESSAGE)",
													"type": "Expression"
												}
											}
										},
										{
											"name": "Update EDA_EDL Feed Tables on Failure",
											"type": "SqlServerStoredProcedure",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"storedProcedureName": "[[dbo].[UpdateEDAEDLFeedTablesOnFailure]",
												"storedProcedureParameters": {
													"COMMENTS": {
														"value": {
															"value": "@pipeline().parameters.RUN_MESSAGE",
															"type": "Expression"
														},
														"type": "String"
													},
													"FEED_NAME": {
														"value": {
															"value": "@pipeline().parameters.JOB_NAME",
															"type": "Expression"
														},
														"type": "String"
													},
													"RUN_ID": {
														"value": {
															"value": "@pipeline().parameters.EXEC_RUN_ID",
															"type": "Expression"
														},
														"type": "String"
													},
													"STAGE": {
														"value": {
															"value": "@pipeline().parameters.STAGE_NAME",
															"type": "Expression"
														},
														"type": "String"
													},
													"STATUS": {
														"value": "0",
														"type": "Int32"
													},
													"TASK_ID": {
														"value": {
															"value": "@pipeline().parameters.EXEC_RUN_ID",
															"type": "Expression"
														},
														"type": "String"
													},
													"UPDATE_TS": {
														"value": {
															"value": "@formatDateTime(utcnow(),'yyyy-MM-dd HH:mm:ss')",
															"type": "Expression"
														},
														"type": "DateTime"
													}
												}
											},
											"linkedServiceName": {
												"referenceName": "ls_sqlmi_eda_edl_ctl_fw_db",
												"type": "LinkedServiceReference"
											}
										}
									]
								},
								{
									"value": "SUCCESS",
									"activities": [
										{
											"name": "Update EDA_EDL Feed and MetaData Tables on Success",
											"type": "SqlServerStoredProcedure",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"storedProcedureName": "[[dbo].[UpdateEDAEDLFeedTablesOnSuccess]",
												"storedProcedureParameters": {
													"FEED_NAME": {
														"value": {
															"value": "@pipeline().parameters.JOB_NAME",
															"type": "Expression"
														},
														"type": "String"
													},
													"LAST_SUCC_JOB_RUN_TS": {
														"value": {
															"value": "@convertTimeZone(utcnow(),'UTC','Eastern Standard Time','yyyy-MM-dd HH:mm:ss')",
															"type": "Expression"
														},
														"type": "DateTime"
													},
													"PREV_RUN_REC_DATE": {
														"value": {
															"value": "@if(or(equals(pipeline().parameters.PREV_DELTA_VALUE,'NULL'),empty(pipeline().parameters.PREV_DELTA_VALUE)),'1970-01-01 00:00:00.000',pipeline().parameters.PREV_DELTA_VALUE)",
															"type": "Expression"
														},
														"type": "DateTime"
													},
													"REC_COUNT": {
														"value": {
															"value": "@pipeline().parameters.RECORD_COUNT",
															"type": "Expression"
														},
														"type": "Int64"
													},
													"RUN_ID": {
														"value": {
															"value": "@pipeline().parameters.EXEC_RUN_ID",
															"type": "Expression"
														},
														"type": "String"
													},
													"RUN_REC_DATE": {
														"value": {
															"value": "@if(or(equals(pipeline().parameters.CURR_DELTA_VALUE,'NULL'),empty(pipeline().parameters.CURR_DELTA_VALUE)),'1970-01-01 00:00:00.000',formatDateTime(pipeline().parameters.CURR_DELTA_VALUE,'yyyy-MM-dd HH:mm:ss'))",
															"type": "Expression"
														},
														"type": "DateTime"
													},
													"STAGE": {
														"value": {
															"value": "@pipeline().parameters.STAGE_NAME",
															"type": "Expression"
														},
														"type": "String"
													},
													"STATUS": {
														"value": {
															"value": "1",
															"type": "Expression"
														},
														"type": "Int32"
													},
													"TASK_END_TS": {
														"value": {
															"value": "@convertTimeZone(pipeline().TriggerTime,'UTC','Eastern Standard Time','yyyy-MM-dd HH:mm:ss')",
															"type": "Expression"
														},
														"type": "DateTime"
													},
													"TASK_ID": {
														"value": {
															"value": "@pipeline().parameters.EXEC_RUN_ID",
															"type": "Expression"
														},
														"type": "String"
													},
													"UPDATE_TS": {
														"value": {
															"value": "@formatDateTime(utcnow(),'yyyy-MM-dd HH:mm:ss')",
															"type": "Expression"
														},
														"type": "DateTime"
													},
													"COMMENTS": {
														"value": {
															"value": "@pipeline().parameters.RUN_MESSAGE",
															"type": "Expression"
														},
														"type": "String"
													},
													"ELT_PREV_DELTA_VALUE": {
														"value": {
															"value": "@if(equals(pipeline().parameters.PREV_DELTA_VALUE,'NULL'),pipeline().parameters.PREV_DELTA_VALUE,formatDateTime(pipeline().parameters.PREV_DELTA_VALUE,'yyyy-MM-ddTHH:mm:ss'))",
															"type": "Expression"
														},
														"type": "String"
													},
													"ELT_CURR_DELTA_VALUE": {
														"value": {
															"value": "@if(equals(pipeline().parameters.CURR_DELTA_VALUE,'NULL'),pipeline().parameters.CURR_DELTA_VALUE,formatDateTime(pipeline().parameters.CURR_DELTA_VALUE,'yyyy-MM-ddTHH:mm:ss'))",
															"type": "Expression"
														},
														"type": "String"
													}
												}
											},
											"linkedServiceName": {
												"referenceName": "ls_sqlmi_eda_edl_ctl_fw_db",
												"type": "LinkedServiceReference"
											}
										}
									]
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"EXEC_RUN_ID": {
						"type": "string",
						"defaultValue": "61d8cf05-ad3c-49cf-8fd2-10918140d837"
					},
					"RUN_STATUS": {
						"type": "string",
						"defaultValue": "SUCCESS"
					},
					"RUN_MESSAGE": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					},
					"PREV_DELTA_VALUE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"CURR_DELTA_VALUE": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"JOB_NAME": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					},
					"TASK_START_TS": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"RECORD_COUNT": {
						"type": "string",
						"defaultValue": "10"
					},
					"STAGE_NAME": {
						"type": "string",
						"defaultValue": "STAGE1"
					}
				},
				"variables": {
					"V_EXCEPTION_ARR": {
						"type": "Array"
					},
					"V_ELT_METADATA_TABLE": {
						"type": "String",
						"defaultValue": "EltMetadataControl"
					},
					"V_METADATA_DEF_PARTITION_KEY": {
						"type": "String",
						"defaultValue": "DEFAULT"
					},
					"V_ELT_LOAD_CONTROL_TABLE": {
						"type": "String",
						"defaultValue": "EtlLoadControl"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_sqlmi_eda_edl_ctl_fw_db')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_Updt ELT Execution')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "updt control tables",
						"description": "decide to update the metadata control with SUCCESS and not for FAILED ",
						"type": "Switch",
						"dependsOn": [
							{
								"activity": "Insrt EtlLoadControl_Status",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"on": {
								"value": "@pipeline().parameters.RUN_STATUS",
								"type": "Expression"
							},
							"cases": [
								{
									"value": "FAILED",
									"activities": [
										{
											"name": "Raise_Exception_Finally",
											"description": "Call Raise Exception we got the FAILED status",
											"type": "AppendVariable",
											"dependsOn": [],
											"userProperties": [],
											"typeProperties": {
												"variableName": "V_EXCEPTION_ARR",
												"value": {
													"value": "@array(pipeline().parameters.RUN_MESSAGE)",
													"type": "Expression"
												}
											}
										}
									]
								},
								{
									"value": "SUCCESS",
									"activities": [
										{
											"name": "Upd METADATA DELTA VAL Aftr Dbricks_copy1",
											"description": "Upd METADATA DELTA VAL ",
											"type": "Copy",
											"dependsOn": [],
											"policy": {
												"timeout": "7.00:00:00",
												"retry": 0,
												"retryIntervalInSeconds": 30,
												"secureOutput": false,
												"secureInput": false
											},
											"userProperties": [],
											"typeProperties": {
												"source": {
													"type": "AzureTableSource",
													"additionalColumns": [
														{
															"name": "NEW_DELTA_VALUE",
															"value": {
																"value": "@pipeline().parameters.CURR_DELTA_VALUE",
																"type": "Expression"
															}
														},
														{
															"name": "NEW_WINDOW_START_TIME_UTC",
															"value": {
																"value": "@pipeline().parameters.PREV_DELTA_VALUE",
																"type": "Expression"
															}
														},
														{
															"name": "NEW_WINDOW_END_TIME_UTC",
															"value": {
																"value": "@pipeline().parameters.CURR_DELTA_VALUE",
																"type": "Expression"
															}
														}
													],
													"azureTableSourceQuery": {
														"value": "@concat('PartitionKey eq ''', variables('V_METADATA_DEF_PARTITION_KEY'), '''',' and JOB_NAME eq ','''', pipeline().parameters.JOB_NAME, '''')",
														"type": "Expression"
													},
													"azureTableSourceIgnoreTableNotFound": false
												},
												"sink": {
													"type": "AzureTableSink",
													"azureTableInsertType": "merge",
													"azureTableDefaultPartitionKeyValue": "DEFAULT",
													"azureTableRowKeyName": {
														"value": "RowKey",
														"type": "Expression"
													},
													"writeBatchSize": 10000
												},
												"enableStaging": false,
												"dataIntegrationUnits": 2,
												"translator": {
													"type": "TabularTranslator",
													"mappings": [
														{
															"source": {
																"name": "PartitionKey",
																"type": "String"
															},
															"sink": {
																"name": "PartitionKey",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "RowKey",
																"type": "String"
															},
															"sink": {
																"name": "RowKey",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "Timestamp",
																"type": "DateTimeOffset"
															},
															"sink": {
																"name": "Timestamp",
																"type": "DateTimeOffset"
															}
														},
														{
															"source": {
																"name": "NEW_DELTA_VALUE",
																"type": "String"
															},
															"sink": {
																"name": "CURR_MAX_DELTA_COL_VALUE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "CURR_MAX_DELTA_COL_VALUE_FORMAT",
																"type": "String"
															},
															"sink": {
																"name": "CURR_MAX_DELTA_COL_VALUE_FORMAT",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DBFS_COALESCE",
																"type": "String"
															},
															"sink": {
																"name": "DBFS_COALESCE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DBFS_FILE_FORMAT",
																"type": "String"
															},
															"sink": {
																"name": "DBFS_FILE_FORMAT",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DBFS_PARTITION_BY",
																"type": "String"
															},
															"sink": {
																"name": "DBFS_PARTITION_BY",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DBFS_SAVE_MODE",
																"type": "String"
															},
															"sink": {
																"name": "DBFS_SAVE_MODE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DEST_TBL",
																"type": "String"
															},
															"sink": {
																"name": "DEST_TBL",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "DEST_TYPE",
																"type": "String"
															},
															"sink": {
																"name": "DEST_TYPE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "IS_ACTIVE",
																"type": "String"
															},
															"sink": {
																"name": "IS_ACTIVE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "IS_AZ_AUDIT_COLS_2_ADD",
																"type": "String"
															},
															"sink": {
																"name": "IS_AZ_AUDIT_COLS_2_ADD",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "JOB_NAME",
																"type": "String"
															},
															"sink": {
																"name": "JOB_NAME",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "LOAD_TYPE",
																"type": "String"
															},
															"sink": {
																"name": "LOAD_TYPE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "ODS_LOC",
																"type": "String"
															},
															"sink": {
																"name": "ODS_LOC",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "QRY",
																"type": "String"
															},
															"sink": {
																"name": "QRY",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "RDS_STAGE_FILE_FOLDER",
																"type": "String"
															},
															"sink": {
																"name": "RDS_STAGE_FILE_FOLDER",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "RDS_STAGE_FILE_FORMAT",
																"type": "String"
															},
															"sink": {
																"name": "RDS_STAGE_FILE_FORMAT",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "RDS_STAGE_LOC",
																"type": "String"
															},
															"sink": {
																"name": "RDS_STAGE_LOC",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "SRC_CUSTOM_WHERE_CLAUSE",
																"type": "String"
															},
															"sink": {
																"name": "SRC_CUSTOM_WHERE_CLAUSE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "SRC_DELTA_COL",
																"type": "String"
															},
															"sink": {
																"name": "SRC_DELTA_COL",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "SRC_TBL_FILE_PATH",
																"type": "String"
															},
															"sink": {
																"name": "SRC_TBL_FILE_PATH",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "SRC_TBL_PK_CSV",
																"type": "String"
															},
															"sink": {
																"name": "SRC_TBL_PK_CSV",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "SRC_TYPE",
																"type": "String"
															},
															"sink": {
																"name": "SRC_TYPE",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "NEW_WINDOW_END_TIME_UTC"
															},
															"sink": {
																"name": "WINDOW_END_TIME_UTC",
																"type": "String"
															}
														},
														{
															"source": {
																"name": "NEW_WINDOW_START_TIME_UTC"
															},
															"sink": {
																"name": "WINDOW_START_TIME_UTC",
																"type": "String"
															}
														}
													]
												}
											},
											"inputs": [
												{
													"referenceName": "DS_ETL_LOAD_CONTROL",
													"type": "DatasetReference",
													"parameters": {
														"AZ_STORAGE_TABLE": {
															"value": "@variables('V_ELT_METADATA_TABLE')",
															"type": "Expression"
														}
													}
												}
											],
											"outputs": [
												{
													"referenceName": "DS_ETL_LOAD_CONTROL",
													"type": "DatasetReference",
													"parameters": {
														"AZ_STORAGE_TABLE": "EltMetadataControl"
													}
												}
											]
										}
									]
								}
							]
						}
					},
					{
						"name": "Insrt EtlLoadControl_Status",
						"description": "Record the log entry into load control table for success or failure or message ",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureTableSource",
								"additionalColumns": [
									{
										"name": "RUN_STATUS",
										"value": {
											"value": "@pipeline().parameters.RUN_STATUS",
											"type": "Expression"
										}
									},
									{
										"name": "RUN_ID",
										"value": {
											"value": "@pipeline().parameters.EXEC_RUN_ID",
											"type": "Expression"
										}
									},
									{
										"name": "RUN_MESSAGE",
										"value": {
											"value": "@pipeline().parameters.RUN_MESSAGE",
											"type": "Expression"
										}
									}
								],
								"azureTableSourceQuery": {
									"value": "@concat('PartitionKey eq ''', variables('V_METADATA_DEF_PARTITION_KEY'), '''',' and RowKey eq ','''', pipeline().parameters.JOB_NAME, '''')",
									"type": "Expression"
								},
								"azureTableSourceIgnoreTableNotFound": false
							},
							"sink": {
								"type": "AzureTableSink",
								"azureTableInsertType": "merge",
								"azureTableDefaultPartitionKeyValue": {
									"value": "@pipeline().parameters.JOB_NAME",
									"type": "Expression"
								},
								"writeBatchSize": 10000
							},
							"enableStaging": false,
							"dataIntegrationUnits": 2,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "PartitionKey",
											"type": "String"
										},
										"sink": {
											"name": "PartitionKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RowKey",
											"type": "String"
										},
										"sink": {
											"name": "RowKey",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "Timestamp",
											"type": "DateTimeOffset"
										},
										"sink": {
											"name": "Timestamp",
											"type": "DateTimeOffset"
										}
									},
									{
										"source": {
											"name": "RUN_ID",
											"type": "String"
										},
										"sink": {
											"name": "EXEC_ID",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RUN_MESSAGE",
											"type": "String"
										},
										"sink": {
											"name": "MESSAGE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "RUN_STATUS",
											"type": "String"
										},
										"sink": {
											"name": "STATUS",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "CURR_MAX_DELTA_COL_VALUE",
											"type": "String"
										},
										"sink": {
											"name": "CURR_DELTA_VALUE",
											"type": "String"
										}
									},
									{
										"source": {
											"name": "SRC_DELTA_COL",
											"type": "String"
										},
										"sink": {
											"name": "DELTA_COL"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "DS_ETL_LOAD_CONTROL",
								"type": "DatasetReference",
								"parameters": {
									"AZ_STORAGE_TABLE": {
										"value": "@variables('V_ELT_METADATA_TABLE')",
										"type": "Expression"
									}
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DS_ETL_LOAD_CONTROL",
								"type": "DatasetReference",
								"parameters": {
									"AZ_STORAGE_TABLE": {
										"value": "@variables('V_ELT_LOAD_CONTROL_TABLE')",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"EXEC_RUN_ID": {
						"type": "string",
						"defaultValue": "61d8cf05-ad3c-49cf-8fd2-10918140d837"
					},
					"RUN_STATUS": {
						"type": "string",
						"defaultValue": "SUCCESS"
					},
					"RUN_MESSAGE": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					},
					"PREV_DELTA_VALUE": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					},
					"CURR_DELTA_VALUE": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					},
					"JOB_NAME": {
						"type": "string",
						"defaultValue": "DC.DC_E_NR_NRCELLDU_DAY"
					}
				},
				"variables": {
					"V_EXCEPTION_ARR": {
						"type": "Array"
					},
					"V_ELT_METADATA_TABLE": {
						"type": "String",
						"defaultValue": "EltMetadataControl"
					},
					"V_METADATA_DEF_PARTITION_KEY": {
						"type": "String",
						"defaultValue": "DEFAULT"
					},
					"V_ELT_LOAD_CONTROL_TABLE": {
						"type": "String",
						"defaultValue": "EtlLoadControl"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:27:59Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/DS_ETL_LOAD_CONTROL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_fin_FILE_CHECKER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Pipeline to check if fin file exists or not .\nFor now only for FTP later include with switch for other src types too",
				"activities": [
					{
						"name": "If fin file exists",
						"description": "Check for fin file existence and this got to be done one and only if the file pattern ends with .fin !!!!!!",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Check and Move Fin file",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@not(and(endsWith(pipeline().parameters.SRC_TBL_FILE_NAME_PATTERN, '.fin') ,equals(activity('Check and Move Fin file').output.filesWritten, 0)))",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "set output_message for fin chk failure",
									"description": "This is more like a err or info message to look upon",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_OUTPUT_MESSAGE",
										"value": "i am expecting a fin file but :( !!"
									}
								},
								{
									"name": "ERR_FIN_FIN_NOT_FOUND",
									"description": "Please check the fin file ",
									"type": "AppendVariable",
									"dependsOn": [
										{
											"activity": "set output_message for fin chk failure",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "V_ERR_MESSAGE",
										"value": {
											"value": "@int(variables('V_OUTPUT_MESSAGE'))",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Check and Move Fin file",
						"description": "This moves the fin file to archive directory and if not found it fails. \nIf the pattern does not endWith \".fin\" then we just silently come out !!",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "BinarySource",
								"storeSettings": {
									"type": "FtpReadSettings",
									"recursive": true,
									"wildcardFolderPath": {
										"value": "@pipeline().parameters.SRC_TBL_FILE_PATH",
										"type": "Expression"
									},
									"wildcardFileName": {
										"value": "@pipeline().parameters.SRC_TBL_FILE_NAME_PATTERN",
										"type": "Expression"
									},
									"useBinaryTransfer": true,
									"deleteFilesAfterCompletion": true
								},
								"formatSettings": {
									"type": "BinaryReadSettings"
								}
							},
							"sink": {
								"type": "BinarySink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "NTW_FTP_Datasets",
								"type": "DatasetReference",
								"parameters": {
									"SRC_DATASET_PATH": "IN/"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "BLOB_Binary_Datasets",
								"type": "DatasetReference",
								"parameters": {
									"CONTAINER": {
										"value": "@variables('V_NW_ARCHIVE_BLOB')",
										"type": "Expression"
									},
									"FOLDER_FILE": {
										"value": "@concat(pipeline().parameters.SRC_TYPE, '/', pipeline().parameters.DEST_TBL, '/', pipeline().parameters.ID)",
										"type": "Expression"
									}
								}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"SRC_TBL_FILE_PATH": {
						"type": "string",
						"defaultValue": "IN/ENIQ/eniq_dc_e_nr_nrcelldu_day"
					},
					"SRC_TBL_FILE_NAME_PATTERN": {
						"type": "string",
						"defaultValue": "eniq2*.fin2"
					},
					"SRC_TYPE": {
						"type": "string",
						"defaultValue": "NW_FTP"
					},
					"DEST_TBL": {
						"type": "string",
						"defaultValue": "FIN_FILES"
					},
					"ID": {
						"type": "string",
						"defaultValue": "utc_now"
					}
				},
				"variables": {
					"V_OUTPUT_MESSAGE": {
						"type": "String"
					},
					"V_ERR_MESSAGE": {
						"type": "Array"
					},
					"V_NW_ARCHIVE_BLOB": {
						"type": "String",
						"defaultValue": "rogers-eda-raw-prd-sensitive-storage/networth/nw-archive"
					}
				},
				"folder": {
					"name": "Data Ingestion FrmWrk"
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/NTW_FTP_Datasets')]",
				"[concat(variables('factoryId'), '/datasets/BLOB_Binary_Datasets')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Remedy_Data_move')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OrcSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFolderPath": "remedy.db/RADIOENG_ERP_SITEINFO",
									"wildcardFileName": "*",
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "OrcSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "OrcWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CNE_BlobStorage",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EDL_Remedy",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:02Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/CNE_BlobStorage')]",
				"[concat(variables('factoryId'), '/datasets/EDL_Remedy')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TEST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlMISource",
								"sqlReaderQuery": "\nupdate dbo.elt_metadata_control \nset SRC_TBL_PK_CSV= 'NULL'\nwhere JOB_NAME like '%LOAD_ORA_BDW_APP_IBRO_IBRO_HOUSEHOLD_ACTIVITY_CH%'",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "EDA_EDL_SQLMI_Datasets",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/EDA_EDL_SQLMI_Datasets')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/planet_pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "pipeline to read and process Planet coverage data files ",
				"activities": [
					{
						"name": "Notebook1",
						"type": "DatabricksNotebook",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"notebookPath": "/Users/sachin.sharma@rci.rogers.ca/param_test",
							"baseParameters": {
								"dir": {
									"value": "@pipeline().parameters.dir",
									"type": "Expression"
								},
								"month": {
									"value": "@pipeline().parameters.month",
									"type": "Expression"
								},
								"year": {
									"value": "@pipeline().parameters.year",
									"type": "Expression"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Networth_DataBricks",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "result_variable",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Notebook1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "dbr_result",
							"value": {
								"value": "@activity('Notebook1').output.runOutput",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"dir": {
						"type": "string",
						"defaultValue": "/dbfs/planet-files/"
					},
					"year": {
						"type": "string",
						"defaultValue": "2022"
					},
					"month": {
						"type": "string",
						"defaultValue": "01"
					},
					"result": {
						"type": "string",
						"defaultValue": "none"
					}
				},
				"variables": {
					"dbr_result": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2022-03-09T16:28:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Networth_DataBricks')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/BLOB_Binary_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Generic Dataset to represent any blob as binary",
				"linkedServiceName": {
					"referenceName": "ls_az_stg_acc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CONTAINER": {
						"type": "string",
						"defaultValue": "nw-rds"
					},
					"FOLDER_FILE": {
						"type": "string"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@dataset().FOLDER_FILE",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().CONTAINER",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CNE_BlobStorage')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CNE_Azure_Account",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Orc",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "eniq.db/DC_E_ERBS_EUTRANCELLFDD_V_DAY",
						"container": "nw-ods"
					},
					"enablePhysicalSchema": true
				},
				"schema": [
					{
						"type": "INT",
						"name": "_col0"
					},
					{
						"type": "INT",
						"name": "_col1"
					},
					{
						"type": "LONG",
						"name": "_col2"
					},
					{
						"type": "INT",
						"name": "_col3"
					},
					{
						"type": "STRING",
						"name": "_col4"
					},
					{
						"type": "STRING",
						"name": "_col5"
					},
					{
						"type": "INT",
						"name": "_col6"
					},
					{
						"type": "STRING",
						"name": "_col7"
					},
					{
						"type": "INT",
						"name": "_col8"
					},
					{
						"type": "STRING",
						"name": "_col9"
					},
					{
						"type": "STRING",
						"name": "_col10"
					},
					{
						"type": "STRING",
						"name": "_col11"
					},
					{
						"type": "STRING",
						"name": "_col12"
					},
					{
						"type": "INT",
						"name": "_col13"
					},
					{
						"type": "STRING",
						"name": "_col14"
					},
					{
						"type": "STRING",
						"name": "_col15"
					},
					{
						"type": "LONG",
						"name": "_col16"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col17"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col18"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col19"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col20"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col21"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col22"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col23"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col24"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col25"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col26"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col27"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col28"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col29"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col30"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col31"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col32"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col33"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col34"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col35"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col36"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col37"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col38"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col39"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col40"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col41"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col42"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col43"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col44"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col45"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col46"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col47"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col48"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col49"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col50"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col51"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col52"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col53"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col54"
					},
					{
						"precision": 18,
						"scale": 0,
						"type": "DECIMAL",
						"name": "_col55"
					},
					{
						"type": "STRING",
						"name": "_col56"
					},
					{
						"type": "LONG",
						"name": "_col57"
					},
					{
						"type": "STRING",
						"name": "_col58"
					},
					{
						"type": "STRING",
						"name": "_col59"
					},
					{
						"type": "INT",
						"name": "_col60"
					},
					{
						"type": "INT",
						"name": "_col61"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/CNE_Azure_Account')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSV_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Datasets for representing text CSV files",
				"linkedServiceName": {
					"referenceName": "ls_az_stg_acc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "@pipeline().parameters.RDS_STAGE_LOC"
					},
					"RDS_STAGE_FILE_FOLDER": {
						"type": "String",
						"defaultValue": "@pipeline().parameters.RDS_STAGE_FILE_FOLDER"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().RDS_STAGE_FILE_FOLDER",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().RDS_STAGE_FILE_FOLDER",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().RDS_STAGE_LOC",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": false,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DAR_SQLMI_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Dataset for DAR SQLMI db",
				"linkedServiceName": {
					"referenceName": "ls_az_sql_dar_db",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "AzureSqlMITable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_sql_dar_db')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_4_PARQUET')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_4_gen2",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CONTAINER": {
						"type": "string"
					},
					"FOLDER_FILE": {
						"type": "string"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().FOLDER_FILE",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().CONTAINER",
							"type": "Expression"
						}
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_4_gen2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DS_ETL_LOAD_CONTROL')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Generic Dataset representing azure storage tables",
				"linkedServiceName": {
					"referenceName": "ls_az_storage_table",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"AZ_STORAGE_TABLE": {
						"type": "String"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "AzureTable",
				"schema": [],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().AZ_STORAGE_TABLE",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_storage_table')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDA_EDL_SQLMI_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_sqlmi_eda_edl_ctl_fw_db",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "AzureSqlMITable",
				"schema": [
					{
						"name": "JOB_NAME",
						"type": "nvarchar"
					},
					{
						"name": "CSV_HEADER_FLG",
						"type": "nvarchar"
					},
					{
						"name": "CURR_MAX_DELTA_COL_VALUE",
						"type": "nvarchar"
					},
					{
						"name": "CURR_MAX_DELTA_COL_VALUE_FORMAT",
						"type": "nvarchar"
					},
					{
						"name": "DBFS_COALESCE",
						"type": "nvarchar"
					},
					{
						"name": "DBFS_FILE_FORMAT",
						"type": "nvarchar"
					},
					{
						"name": "DBFS_PARTITION_BY",
						"type": "nvarchar"
					},
					{
						"name": "DBFS_SAVE_MODE",
						"type": "nvarchar"
					},
					{
						"name": "DEST_TBL",
						"type": "nvarchar"
					},
					{
						"name": "DEST_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "FAIL_ON_NO_DATA",
						"type": "nvarchar"
					},
					{
						"name": "HDFS_PARTITION_COL_FORMAT",
						"type": "nvarchar"
					},
					{
						"name": "INFO_APP_OWNER",
						"type": "nvarchar"
					},
					{
						"name": "INFO_BIZ_UNIT",
						"type": "nvarchar"
					},
					{
						"name": "INFO_COST_CENTER",
						"type": "nvarchar"
					},
					{
						"name": "INFO_DATASET_DETAILS",
						"type": "nvarchar"
					},
					{
						"name": "IS_ACTIVE",
						"type": "nvarchar"
					},
					{
						"name": "IS_AZ_AUDIT_COLS_2_ADD",
						"type": "nvarchar"
					},
					{
						"name": "LOAD_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "MAPPING",
						"type": "nvarchar"
					},
					{
						"name": "ODS_LOC",
						"type": "nvarchar"
					},
					{
						"name": "PARTITION_THRESHOLD",
						"type": "nvarchar"
					},
					{
						"name": "PARTITION_THRESHOLD_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "PURGE_FREQ_DAYS",
						"type": "nvarchar"
					},
					{
						"name": "QRY",
						"type": "nvarchar"
					},
					{
						"name": "RDS_STAGE_FILE_FOLDER",
						"type": "nvarchar"
					},
					{
						"name": "RDS_STAGE_FILE_FORMAT",
						"type": "nvarchar"
					},
					{
						"name": "RDS_STAGE_LOC",
						"type": "nvarchar"
					},
					{
						"name": "SRC_CSV_HEADER_FLG",
						"type": "nvarchar"
					},
					{
						"name": "SRC_CUSTOM_WHERE_CLAUSE",
						"type": "nvarchar"
					},
					{
						"name": "SRC_DELTA_COL",
						"type": "nvarchar"
					},
					{
						"name": "SRC_TBL_FILE_NAME_PATTERN",
						"type": "nvarchar"
					},
					{
						"name": "SRC_TBL_FILE_PATH",
						"type": "nvarchar"
					},
					{
						"name": "SRC_TBL_FILE_PATTERN",
						"type": "nvarchar"
					},
					{
						"name": "SRC_TBL_PK_CSV",
						"type": "nvarchar"
					},
					{
						"name": "SRC_TYPE",
						"type": "nvarchar"
					},
					{
						"name": "WINDOW_END_TIME_UTC",
						"type": "nvarchar"
					},
					{
						"name": "WINDOW_START_TIME_UTC",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "elt_metadata_control"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_sqlmi_eda_edl_ctl_fw_db')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EDL_Remedy')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "edl_storage_account",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Orc",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "networth/remedy.db/RADIOENG_ERP_SITEINFO",
						"container": "rogers-eda-raw-prd-sensitive-storage"
					},
					"enablePhysicalSchema": true
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/edl_storage_account')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ENIQ_EDL_ORC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_az_stg_acc",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Orc",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "DC_E_ERBS_EUTRANCELLFDD_V_DAY",
						"container": "rogers-eda-raw-prd-sensitive-storage/networth/eniq.db"
					},
					"enablePhysicalSchema": true
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HDFS_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "A Generic Dataset for representing HDFS files in Binary format ",
				"linkedServiceName": {
					"referenceName": "UserCredentials_A",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HdfsLocation"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/UserCredentials_A')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/HDFS_Secondary_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "HA Dataset from HA webHDFS url ",
				"linkedServiceName": {
					"referenceName": "ls_hdfs_secondary_on_prem",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "HdfsLocation"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_hdfs_secondary_on_prem')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/JSON_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_4_gen2",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"CONTAINER": {
						"type": "string",
						"defaultValue": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), variables('V_ODS_LOC'), concat(variables('V_RDS_STAGE_LOC'), '/', pipeline().parameters.SRC_TYPE, '-STAGE'))"
					},
					"FOLDER_FILE": {
						"type": "string",
						"defaultValue": "@if(equals(pipeline().parameters.DEST_TYPE, 'ODS'), pipeline().parameters.ODS_LOC, pipeline().parameters.DEST_TBL)"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Json",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().FOLDER_FILE",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().CONTAINER",
							"type": "Expression"
						}
					}
				},
				"schema": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_4_gen2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/NNMi_Dataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_ftp_ntw_server_new",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "FtpServerLocation",
						"folderPath": "IN/NNMI"
					},
					"compression": {
						"type": "gzip",
						"level": "Fastest"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_ftp_ntw_server_new')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/NTW_FTP_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Dataset to represent any files from NTW_FTP server",
				"linkedServiceName": {
					"referenceName": "ls_ftp_ntw_server",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"SRC_DATASET_PATH": {
						"type": "String",
						"defaultValue": "IN/"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "FtpServerLocation",
						"folderPath": {
							"value": "@dataset().SRC_DATASET_PATH",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_ftp_ntw_server')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ORA_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_ora_db",
					"type": "LinkedServiceReference",
					"parameters": {
						"hostNm": {
							"value": "@dataset().hostNm",
							"type": "Expression"
						},
						"port": {
							"value": "@dataset().port",
							"type": "Expression"
						},
						"serviceNm": {
							"value": "@dataset().serviceNm",
							"type": "Expression"
						},
						"pwd": {
							"value": "@dataset().pwd",
							"type": "Expression"
						},
						"UserNm": {
							"value": "@dataset().userNm",
							"type": "Expression"
						}
					}
				},
				"parameters": {
					"hostNm": {
						"type": "string"
					},
					"port": {
						"type": "string"
					},
					"serviceNm": {
						"type": "string"
					},
					"userNm": {
						"type": "string"
					},
					"pwd": {
						"type": "string"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_ora_db')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ORA_ELA_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_bdw_oracle",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "OracleTable",
				"schema": [],
				"typeProperties": {
					"schema": "",
					"table": ""
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_bdw_oracle')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RDS_STAGE_CSV_DataSets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Datasets for representing text DSV files",
				"linkedServiceName": {
					"referenceName": "ls_az_stg_acc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"RDS_STAGE_LOC": {
						"type": "String",
						"defaultValue": "@pipeline().parameters.RDS_STAGE_LOC"
					},
					"RDS_STAGE_FILE_FOLDER": {
						"type": "String",
						"defaultValue": "@pipeline().parameters.RDS_STAGE_FILE_FOLDER"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().RDS_STAGE_FILE_FOLDER",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().RDS_STAGE_FILE_FOLDER",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().RDS_STAGE_LOC",
							"type": "Expression"
						}
					},
					"columnDelimiter": "\t",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SAS_Datasets')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_sas_sftp_server",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "SftpLocation"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_sas_sftp_server')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Spatialnet')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "ls_onprem_vm_file_system",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": false,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_onprem_vm_file_system')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_4_deletion')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Generic Dataset to help clean up using DFS API",
				"linkedServiceName": {
					"referenceName": "ls_4_gen2_deletion",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"container": {
						"type": "string",
						"defaultValue": "nw-ods"
					},
					"path": {
						"type": "string"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": {
							"value": "@dataset().path",
							"type": "Expression"
						},
						"fileSystem": {
							"value": "@dataset().container",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_4_gen2_deletion')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ds_blob_sink_4_hdfs')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "A generic blob to store the HDFS pulled files as Binary.\n\nthis can be replaced with blob_binary_datasets",
				"linkedServiceName": {
					"referenceName": "ls_az_stg_acc",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"RDS_STAGE_LOC": {
						"type": "string",
						"defaultValue": "NULL"
					},
					"RDS_STAGE_FOLDER": {
						"type": "string",
						"defaultValue": "NULL"
					}
				},
				"folder": {
					"name": "DataSets_4_DIF"
				},
				"annotations": [],
				"type": "Binary",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@dataset().RDS_STAGE_FOLDER",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().RDS_STAGE_LOC",
							"type": "Expression"
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_az_stg_acc')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDatabricksDeltaLake1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricksDeltaLake",
				"typeProperties": {
					"domain": "https://adb-1348407712854365.5.azuredatabricks.net",
					"clusterId": "0518-163526-chid563",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('AzureDatabricksDeltaLake1_accessToken')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureDatacopyls')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDatacopyls_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDatacopyls_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureKeyVault1')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('AzureKeyVault1_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CNE_Azure_Account')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('CNE_Azure_Account_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dev_Networth_Hadoop')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('Dev_Networth_Hadoop_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('Dev_Networth_Hadoop_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-hdfs-service-id-pwd"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Hdfs1_self')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('Hdfs1_self_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('Hdfs1_self_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('Hdfs1_self_password')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Link_CNE_Storage_Account')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('Link_CNE_Storage_Account_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('Link_CNE_Storage_Account_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Networth_DataBricks')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-1348407712854365.5.azuredatabricks.net",
					"accessToken": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-dbricks-token",
						"secretVersion": ""
					},
					"newClusterNodeType": "Standard_DS3_v2",
					"newClusterNumOfWorker": "2",
					"newClusterSparkConf": {
						"spark.hadoop.mapreduce.fileoutputcommitter.cleanup.skipped": "false",
						"spark.yarn.preserve.staging.files": "false"
					},
					"newClusterVersion": "7.3.x-scala2.12",
					"newClusterInitScripts": [],
					"clusterOption": "Fixed"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Networth_Key_Vault')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Networth key vault",
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('Networth_Key_Vault_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Oracle_prod_test')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('Oracle_prod_test_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/UserCredentials_A')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('UserCredentials_A_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('UserCredentials_A_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('UserCredentials_A_password')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/UserLevelAccess-S')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('UserLevelAccess-S_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('UserLevelAccess-S_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('UserLevelAccess-S_password')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/dev_hadoop_connectivity')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('dev_hadoop_connectivity_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('dev_hadoop_connectivity_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "Networth_Key_Vault",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-hdfs-service-id-pwd"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/Networth_Key_Vault')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/edl_storage_account')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('edl_storage_account_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_4_gen2')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "this is mainly used for abfs way access using dfs protocol",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('ls_4_gen2_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('ls_4_gen2_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_4_gen2_deletion')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for clearing the rds-stage using DFS api  ",
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('ls_4_gen2_deletion_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('ls_4_gen2_deletion_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_5g_data_enablment_az_kv')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Key Vault for Prod Linked Service",
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('ls_5g_data_enablment_az_kv_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_amazon_awsp3')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Connect to AWS S3 file system to copy AWSP3 latest zip file",
				"annotations": [],
				"type": "Sftp",
				"typeProperties": {
					"host": "[parameters('ls_amazon_awsp3_properties_typeProperties_host')]",
					"port": 22,
					"skipHostKeyValidation": true,
					"authenticationType": "SshPublicKey",
					"userName": "[parameters('ls_amazon_awsp3_properties_typeProperties_userName')]",
					"privateKeyContent": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-5g-data-enablement-awsp3-id-pwd"
					},
					"passPhrase": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-5g-data-enablement-awsp3-id-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_5g_data_enablment_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_az_sql_dar_db')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked service to connect to Darwin SQL MI Instance - Dev ",
				"annotations": [],
				"type": "AzureSqlMI",
				"typeProperties": {
					"connectionString": "[parameters('ls_az_sql_dar_db_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_az_stg_acc')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for network containers in Azure Storage Account  ",
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('ls_az_stg_acc_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_az_storage_table')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for connecting to storage tables. Mainly for load control and metadata control tables  ",
				"annotations": [],
				"type": "AzureTableStorage",
				"typeProperties": {
					"connectionString": "[parameters('ls_az_storage_table_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_bdw_oracle')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('ls_bdw_oracle_connectionString')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-orl-service-id-password"
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_bdw_oracle_qa')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('ls_bdw_oracle_qa_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_cradlepoint_rest_api')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This is for connecting to Cradlepoint REST endpoints",
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('ls_cradlepoint_rest_api_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_databricks_eniq_raw')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for connecting to ADB from ADF pipelines ",
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://canadacentral.azuredatabricks.net",
					"accessToken": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-5g-data-enablement-dbricks-token",
						"secretVersion": ""
					},
					"newClusterNodeType": "Standard_DS5_v2",
					"newClusterNumOfWorker": "2",
					"newClusterSparkConf": {
						"spark.hadoop.mapreduce.fileoutputcommitter.cleanup.skipped": "false",
						"spark.yarn.preserve.staging.files": "false"
					},
					"newClusterVersion": "6.5.x-scala2.11",
					"newClusterInitScripts": [],
					"clusterOption": "Fixed"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_5g_data_enablment_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_databricks_networth')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-1348407712854365.5.azuredatabricks.net",
					"accessToken": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-dbricks-token"
					},
					"newClusterNodeType": "Standard_E16ds_v4",
					"newClusterNumOfWorker": "3:6",
					"newClusterSparkEnvVars": {
						"PYSPARK_PYTHON": "/databricks/python3/bin/python3"
					},
					"newClusterVersion": "8.3.x-scala2.12",
					"newClusterInitScripts": [],
					"clusterOption": "Fixed"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_databricks_networth_raw')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://adb-1348407712854365.5.azuredatabricks.net",
					"accessToken": {
						"type": "SecureString",
						"value": "[parameters('ls_databricks_networth_raw_accessToken')]"
					},
					"newClusterNodeType": "Standard_DS3_v2",
					"newClusterNumOfWorker": "1",
					"newClusterSparkConf": {
						"spark.hadoop.mapreduce.fileoutputcommitter.cleanup.skipped": "false",
						"spark.yarn.preserve.staging.files": "false"
					},
					"newClusterVersion": "8.2.x-scala2.12",
					"newClusterInitScripts": [],
					"clusterOption": "Fixed"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_ftp_ntw_server')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service to connect to FTP Server created for Network Porfolio",
				"annotations": [],
				"type": "FtpServer",
				"typeProperties": {
					"host": "[parameters('ls_ftp_ntw_server_properties_typeProperties_host')]",
					"port": 21,
					"enableSsl": true,
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('ls_ftp_ntw_server_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-nw-ftp-server-adf-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_5g_data_enablment_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_ftp_ntw_server_new')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service to connect to FTP Server created for Network Porfolio",
				"annotations": [],
				"type": "FtpServer",
				"typeProperties": {
					"host": "[parameters('ls_ftp_ntw_server_new_properties_typeProperties_host')]",
					"port": 21,
					"enableSsl": true,
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('ls_ftp_ntw_server_new_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_smoke_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-nw-ftp-server-adf-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_smoke_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_hdfs_primary_on_prem')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service to connect to on-prem HDFS using webHDFS ",
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('ls_hdfs_primary_on_prem_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('ls_hdfs_primary_on_prem_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "AzureKeyVault1",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-networth-hdfs-service-id-pwd",
						"secretVersion": ""
					}
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]",
				"[concat(variables('factoryId'), '/linkedServices/AzureKeyVault1')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_hdfs_secondary_on_prem')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for connecting to onprem HDFS cluster using secondarywebHDFS API. Needs Self hosted IR with KDC setup ",
				"annotations": [],
				"type": "Hdfs",
				"typeProperties": {
					"url": "[parameters('ls_hdfs_secondary_on_prem_properties_typeProperties_url')]",
					"authenticationType": "Windows",
					"userName": "[parameters('ls_hdfs_secondary_on_prem_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-5g-data-enablement-hdfs-service-id-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_5g_data_enablment_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_onprem_vm_file_system')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "FileServer",
				"typeProperties": {
					"host": "[parameters('ls_onprem_vm_file_system_properties_typeProperties_host')]",
					"userId": "[parameters('ls_onprem_vm_file_system_properties_typeProperties_userId')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_smoke_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-smoke-onprem-vm-fs"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_smoke_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_ora_db')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Parameterised connection to onprem oracle db.",
				"parameters": {
					"hostNm": {
						"type": "string"
					},
					"port": {
						"type": "string"
					},
					"UserNm": {
						"type": "string"
					},
					"serviceNm": {
						"type": "string"
					},
					"pwd": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('ls_ora_db_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_oracle')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "Oracle",
				"typeProperties": {
					"connectionString": "[parameters('ls_oracle_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_sas_sftp_server')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked service to connect to SAS SFTP server",
				"annotations": [],
				"type": "Sftp",
				"typeProperties": {
					"host": "[parameters('ls_sas_sftp_server_properties_typeProperties_host')]",
					"port": 22,
					"skipHostKeyValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('ls_sas_sftp_server_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_smoke_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-smoke-sas-sftp-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_smoke_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_smoke_az_kv')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Key Vault for Prod Linked Service",
				"annotations": [],
				"type": "AzureKeyVault",
				"typeProperties": {
					"baseUrl": "[parameters('ls_smoke_az_kv_properties_typeProperties_baseUrl')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_smoke_databricks')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service for connecting to ADB from ADF pipelines ",
				"annotations": [],
				"type": "AzureDatabricks",
				"typeProperties": {
					"domain": "https://canadacentral.azuredatabricks.net",
					"accessToken": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_smoke_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-smoke-dbricks-token",
						"secretVersion": ""
					},
					"newClusterNodeType": "Standard_DS3_v2",
					"newClusterNumOfWorker": "2",
					"newClusterSparkConf": {
						"spark.hadoop.mapreduce.fileoutputcommitter.cleanup.skipped": "false",
						"spark.yarn.preserve.staging.files": "false"
					},
					"newClusterSparkEnvVars": {
						"PYSPARK_PYTHON": "/databricks/python3/bin/python3"
					},
					"newClusterVersion": "5.5.x-scala2.11",
					"newClusterInitScripts": [],
					"clusterOption": "Fixed"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_smoke_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ls_sqlmi_eda_edl_ctl_fw_db')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Linked Service to connect to EDA_EDL_CTL_FW Database",
				"annotations": [],
				"type": "AzureSqlMI",
				"typeProperties": {
					"connectionString": "[parameters('ls_sqlmi_eda_edl_ctl_fw_db_connectionString')]"
				},
				"connectVia": {
					"referenceName": "networthir",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/networthir')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ookla_http_server_linked_service')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This linked service will be used to connect to ookla server to download speed test files.",
				"annotations": [],
				"type": "HttpServer",
				"typeProperties": {
					"url": "[parameters('ookla_http_server_linked_service_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Basic",
					"userName": "[parameters('ookla_http_server_linked_service_properties_typeProperties_userName')]",
					"password": {
						"type": "AzureKeyVaultSecret",
						"store": {
							"referenceName": "ls_5g_data_enablment_az_kv",
							"type": "LinkedServiceReference"
						},
						"secretName": "secret-5g-data-enablement-ookla-id-pwd"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/ls_5g_data_enablment_az_kv')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/networthir')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		}
	]
}